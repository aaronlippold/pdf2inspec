{
  "name": "cis_mysql_enterprise_foundations_baseline",
  "title": "InSpec Profile",
  "maintainer": "The Authors",
  "copyright": "The Authors",
  "copyright_email": "you@example.com",
  "license": "Apache-2.0",
  "summary": "An InSpec Compliance Profile",
  "version": "0.1.0",
  "supports": [],
  "controls": [
    {
      "title": "5.9 Ensure DML/DDL Grants Are Limited to Specific Databases and Users\n(Scored)",
      "desc": "DML/DDL includes the set of privileges used to modify or create data\nstructures.  This includes INSERT, SELECT, UPDATE, DELETE, DROP, CREATE, and\nALTER privileges. INSERT, SELECT, UPDATE, DELETE, DROP, CREATE, and ALTER are\npowerful privileges in any database.  Such privileges should be limited only to\nthose users requiring such rights.  By limiting the users with these rights and\nensuring that they are limited to specific databases, the attack surface of the\ndatabase is reduced.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "5.9",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to audit this setting:\n\nSELECT User,Host,Db\nFROM mysql.db\nWHERE Select_priv='Y'\nOR Insert_priv='Y'\nOR Update_priv='Y'\nOR Delete_priv='Y'\nOR Create_priv='Y'\nOR Drop_priv='Y'\nOR Alter_priv='Y';\nEnsure all users returned should have these privileges on the indicated\ndatabases.\nNOTE: Global grants are covered in Recommendation 4.1.\n",
        "fix": "Perform the following steps to remediate this setting: Enumerate\nthe unauthorized users, hosts, and databases returned in the result set of\nthe audit procedure For each user, issue the following SQL statement (replace\n'<user>' with the\nunauthorized user, '<host>' with host name, and '<database>' with the database\n\nname):\nREVOKE\nREVOKE\nREVOKE\nREVOKE\nREVOKE\nREVOKE\nREVOKE SELECT ON <host>.<database> FROM <user>;\nINSERT ON <host>.<database> FROM <user>;\nUPDATE ON <host>.<database> FROM <user>;\nDELETE ON <host>.<database> FROM <user>;\nCREATE ON <host>.<database> FROM <user>;\nDROP ON <host>.<database> FROM <user>;\nALTER ON <host>.<database> FROM <user>;"
      },
      "code": "control \"M-5.9\" do\n  title \"5.9 Ensure DML/DDL Grants Are Limited to Specific Databases and Users\n(Scored)\"\n  desc  \"DML/DDL includes the set of privileges used to modify or create data\nstructures.  This includes INSERT, SELECT, UPDATE, DELETE, DROP, CREATE, and\nALTER privileges. INSERT, SELECT, UPDATE, DELETE, DROP, CREATE, and ALTER are\npowerful privileges in any database.  Such privileges should be limited only to\nthose users requiring such rights.  By limiting the users with these rights and\nensuring that they are limited to specific databases, the attack surface of the\ndatabase is reduced. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"5.9\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to audit this setting:\n\nSELECT User,Host,Db\nFROM mysql.db\nWHERE Select_priv='Y'\nOR Insert_priv='Y'\nOR Update_priv='Y'\nOR Delete_priv='Y'\nOR Create_priv='Y'\nOR Drop_priv='Y'\nOR Alter_priv='Y';\nEnsure all users returned should have these privileges on the indicated\ndatabases.\nNOTE: Global grants are covered in Recommendation 4.1.\n\"\n  tag \"fix\": \"Perform the following steps to remediate this setting: Enumerate\nthe unauthorized users, hosts, and databases returned in the result set of\nthe audit procedure For each user, issue the following SQL statement (replace\n'<user>' with the\nunauthorized user, '<host>' with host name, and '<database>' with the database\n\nname):\nREVOKE\nREVOKE\nREVOKE\nREVOKE\nREVOKE\nREVOKE\nREVOKE SELECT ON <host>.<database> FROM <user>;\nINSERT ON <host>.<database> FROM <user>;\nUPDATE ON <host>.<database> FROM <user>;\nDELETE ON <host>.<database> FROM <user>;\nCREATE ON <host>.<database> FROM <user>;\nDROP ON <host>.<database> FROM <user>;\nALTER ON <host>.<database> FROM <user>;\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-5.9.rb",
        "line": 1
      },
      "id": "M-5.9"
    },
    {
      "title": "3.7 Ensure SSL Key Files Have Appropriate Permissions and Ownership\n(Scored)",
      "desc": "When configured to use SSL/TLS, MySQL relies on key files, which are\nstored on the host's filesystem.  These key files are subject to the host's\npermissions and ownership structure. Limiting the accessibility of these\nobjects will protect the confidentiality, integrity, and availability of the\nMySQL database and the communication with the client. If the contents of the\nSSL key file is known to an attacker he or she might impersonate the server.\nThis can be used for a man-­‐in-­‐the-­‐midddle attack. Depending on the SSL\nciphersuite the key might also be used to decipher previously captured network\ntraffic.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/ssl-­‐connections.html ",
        "severity": "medium",
        "cis_id": "3.7",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "To assess this recommendation, locate the SSL key in use\nby executing the following SQL\nstatement to get the Value of ssl_key:\nshow variables where variable_name = 'ssl_key';\nThen, execute the following command to assess the permissions of the Value:\nls -l <ssl_key Value> | egrep '^-r--------[ \\t]*.[ \\t]*mysql[ \\t]*mysql.*$'\n\nLack of output from the above command implies a finding.\n",
        "fix": "Execute the following commands at a terminal prompt to remediate\nthese settings using\nthe Value from the audit procedure:\nchown mysql:mysql <ssl_key Value>\nchmod 400 <ssl_key Value>\n"
      },
      "code": "control \"M-3.7\" do\n  title \"3.7 Ensure SSL Key Files Have Appropriate Permissions and Ownership\n(Scored)\"\n  desc  \"When configured to use SSL/TLS, MySQL relies on key files, which are\nstored on the host's filesystem.  These key files are subject to the host's\npermissions and ownership structure. Limiting the accessibility of these\nobjects will protect the confidentiality, integrity, and availability of the\nMySQL database and the communication with the client. If the contents of the\nSSL key file is known to an attacker he or she might impersonate the server.\nThis can be used for a man-­‐in-­‐the-­‐midddle attack. Depending on the SSL\nciphersuite the key might also be used to decipher previously captured network\ntraffic. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/ssl-­‐connections.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"3.7\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"To assess this recommendation, locate the SSL key in use\nby executing the following SQL\nstatement to get the Value of ssl_key:\nshow variables where variable_name = 'ssl_key';\nThen, execute the following command to assess the permissions of the Value:\nls -l <ssl_key Value> | egrep '^-r--------[ \\\\t]*.[ \\\\t]*mysql[ \\\\t]*mysql.*$'\n\nLack of output from the above command implies a finding.\n\"\n  tag \"fix\": \"Execute the following commands at a terminal prompt to remediate\nthese settings using\nthe Value from the audit procedure:\nchown mysql:mysql <ssl_key Value>\nchmod 400 <ssl_key Value>\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-3.7.rb",
        "line": 1
      },
      "id": "M-3.7"
    },
    {
      "title": "1.1 Place Databases on Non-­‐System Partitions (Scored)",
      "desc": "It is generally accepted that host operating systems should include\ndifferent filesystem partitions for different purposes.  One set of filesystems\nare typically called 'system partitions', and are generally reserved for host\nsystem/application operation.  The other set of filesystems are typically\ncalled 'non-­‐system partitions', and such locations are generally reserved for\nstoring data. Moving the database off the system partition will reduce the\nprobability of denial of service via the exhaustion of available disk space to\nthe operating system.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "1.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following steps to assess this recommendation:\nDiscover the datadir by executing the following SQL statement\nshow variables where variable_name = 'datadir'; Using the returned datadir\nValue from the above query, execute the following in a\nsystem terminal\ndf -h <datadir Value>\nThe output returned from the df command above should not include root ('/'),\n'/var', or\n'/usr'.\n\n",
        "fix": "Perform the following steps to remediate this setting:\nChoose a non-­‐system partition new location for the MySQL data\nStop mysqld using a command like: service mysql stop\nCopy the data using a command like: cp -rp <datadir Value> <new location>\nSet the datadir location to the new location in the MySQL configuration file\nStart mysqld using a command like: service mysql start\nNOTE: On some Linux distributions you may need to additionally modify apparmor\n\nsettings.  For example, on a Ubuntu 14.04.1 system edit the file\n/etc/apparmor.d/usr.sbin.mysqld so that the datadir access is appropriate.  The\n\noriginal might look like this:\n# Allow data dir access\n/var/lib/mysql/ r,\n/var/lib/mysql/** rwk,\nAlter those two paths to be the new location you chose above.  For example, if\nthat new\nlocation were /media/mysql, then the /etc/apparmor.d/usr.sbin.mysqld file\nshould\ninclude something like this:\n# Allow data dir access\n/media/mysql/ r,\n/media/mysql/** rwk,\n",
        "Default Value": "Not Applicable. "
      },
      "code": "control \"M-1.1\" do\n  title \"1.1 Place Databases on Non-­‐System Partitions (Scored)\"\n  desc  \"It is generally accepted that host operating systems should include\ndifferent filesystem partitions for different purposes.  One set of filesystems\nare typically called 'system partitions', and are generally reserved for host\nsystem/application operation.  The other set of filesystems are typically\ncalled 'non-­‐system partitions', and such locations are generally reserved for\nstoring data. Moving the database off the system partition will reduce the\nprobability of denial of service via the exhaustion of available disk space to\nthe operating system. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"1.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following steps to assess this recommendation:\nDiscover the datadir by executing the following SQL statement\nshow variables where variable_name = 'datadir'; Using the returned datadir\nValue from the above query, execute the following in a\nsystem terminal\ndf -h <datadir Value>\nThe output returned from the df command above should not include root ('/'),\n'/var', or\n'/usr'.\n\n\"\n  tag \"fix\": \"Perform the following steps to remediate this setting:\nChoose a non-­‐system partition new location for the MySQL data\nStop mysqld using a command like: service mysql stop\nCopy the data using a command like: cp -rp <datadir Value> <new location>\nSet the datadir location to the new location in the MySQL configuration file\nStart mysqld using a command like: service mysql start\nNOTE: On some Linux distributions you may need to additionally modify apparmor\n\nsettings.  For example, on a Ubuntu 14.04.1 system edit the file\n/etc/apparmor.d/usr.sbin.mysqld so that the datadir access is appropriate.  The\n\noriginal might look like this:\n# Allow data dir access\n/var/lib/mysql/ r,\n/var/lib/mysql/** rwk,\nAlter those two paths to be the new location you chose above.  For example, if\nthat new\nlocation were /media/mysql, then the /etc/apparmor.d/usr.sbin.mysqld file\nshould\ninclude something like this:\n# Allow data dir access\n/media/mysql/ r,\n/media/mysql/** rwk,\n\"\n  tag \"Default Value\": \"Not Applicable. \"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-1.1.rb",
        "line": 1
      },
      "id": "M-1.1"
    },
    {
      "title": "4.8 Ensure 'secure_file_priv' Is Not Empty (Scored)",
      "desc": "The secure_file_priv option restricts to paths used by LOAD DATA\nINFILE or SELECT local_file. It is recommended that this option be set to a\nfile system location that contains only resources expected to be loaded by\nMySQL. Setting secure_file_priv reduces an attacker's ability to read sensitive\nfiles off the affected server via a SQL injection vulnerability.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/server-­‐system-­‐\nvariables.html#sysvar_secure_file_priv ",
        "severity": "medium",
        "cis_id": "4.8",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement and ensure one row is\nreturned:\nSHOW GLOBAL VARIABLES WHERE Variable_name = 'secure_file_priv' AND Value<>'';\nNote: The Value should contain a valid path.\n",
        "fix": "Add the following line to the [mysqld] section of the MySQL\nconfiguration file and restart\nthe MySQL service:\nsecure_file_priv=<path_to_load_directory> ",
        "Default Value": "No value set.\n\n"
      },
      "code": "control \"M-4.8\" do\n  title \"4.8 Ensure 'secure_file_priv' Is Not Empty (Scored)\"\n  desc  \"The secure_file_priv option restricts to paths used by LOAD DATA\nINFILE or SELECT local_file. It is recommended that this option be set to a\nfile system location that contains only resources expected to be loaded by\nMySQL. Setting secure_file_priv reduces an attacker's ability to read sensitive\nfiles off the affected server via a SQL injection vulnerability. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/server-­‐system-­‐\nvariables.html#sysvar_secure_file_priv \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.8\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement and ensure one row is\nreturned:\nSHOW GLOBAL VARIABLES WHERE Variable_name = 'secure_file_priv' AND Value<>'';\nNote: The Value should contain a valid path.\n\"\n  tag \"fix\": \"Add the following line to the [mysqld] section of the MySQL\nconfiguration file and restart\nthe MySQL service:\nsecure_file_priv=<path_to_load_directory> \"\n  tag \"Default Value\": \"No value set.\\n\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-4.8.rb",
        "line": 1
      },
      "id": "M-4.8"
    },
    {
      "title": "3.3 Ensure 'log_error' Has Appropriate Permissions and Ownership\n(Scored)",
      "desc": "MySQL can operate using a variety of log files, each used for\ndifferent purposes.  These are the binary log, error log, slow query log, relay\nlog, audit log and general log.  Because these are files on the host operating\nsystem, they are subject to the permissions and ownership structure provided by\nthe host and may be accessible by users other than the MySQL user. Limiting the\naccessibility of these objects will protect the confidentiality, integrity, and\navailability of the MySQL logs.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following steps to assess this recommendation:\nExecute the following SQL statement to determine the Value of log_error\nshow variables like 'log_error'; Execute the following command at a terminal\nprompt to list all log_error.* files\nls <log_error>.* For each file listed, execute the following command\nls -l <log_error> | egrep '^-[r|w]{2}-[r|w]{2}----\\s*.*$'\nLack of output implies a finding.\n",
        "fix": "Execute the following command for each log file location\nrequiring corrected permissions\nand ownership:\nchmod 660 <log file>\nchown mysql:mysql <log file>\n"
      },
      "code": "control \"M-3.3\" do\n  title \"3.3 Ensure 'log_error' Has Appropriate Permissions and Ownership\n(Scored)\"\n  desc  \"MySQL can operate using a variety of log files, each used for\ndifferent purposes.  These are the binary log, error log, slow query log, relay\nlog, audit log and general log.  Because these are files on the host operating\nsystem, they are subject to the permissions and ownership structure provided by\nthe host and may be accessible by users other than the MySQL user. Limiting the\naccessibility of these objects will protect the confidentiality, integrity, and\navailability of the MySQL logs. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"3.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following steps to assess this recommendation:\nExecute the following SQL statement to determine the Value of log_error\nshow variables like 'log_error'; Execute the following command at a terminal\nprompt to list all log_error.* files\nls <log_error>.* For each file listed, execute the following command\nls -l <log_error> | egrep '^-[r|w]{2}-[r|w]{2}----\\\\s*.*$'\nLack of output implies a finding.\n\"\n  tag \"fix\": \"Execute the following command for each log file location\nrequiring corrected permissions\nand ownership:\nchmod 660 <log file>\nchown mysql:mysql <log file>\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-3.3.rb",
        "line": 1
      },
      "id": "M-3.3"
    },
    {
      "title": "2.2 Do Not Specify Passwords in Command Line (Not Scored)",
      "desc": "When a command is executed on the command line, for example mysql -u\nadmin ppassword, the password may be visible in the user's shell/command\nhistory or in the process list. If the password is visible in the process list\nor user's shell/command history, an attacker will be able to access the MySQL\ndatabase using the stolen credentials.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/mysql-­‐config-­‐editor.html 2.\nhttp://dev.mysql.com/doc/refman/5.7/en/password-­‐security-­‐user.html ",
        "severity": "medium",
        "cis_id": "2.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Check the process or task list if the password is visible.\n\nCheck the shell or command history if the password is visible.\n",
        "fix": "Use -p without password and then enter the password when\nprompted, use a properly\nsecured .my.cnf file, or store authentication information in encrypted format\nin\n.mylogin.cnf.\n"
      },
      "code": "control \"M-2.2\" do\n  title \"2.2 Do Not Specify Passwords in Command Line (Not Scored)\"\n  desc  \"When a command is executed on the command line, for example mysql -u\nadmin ppassword, the password may be visible in the user's shell/command\nhistory or in the process list. If the password is visible in the process list\nor user's shell/command history, an attacker will be able to access the MySQL\ndatabase using the stolen credentials. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/mysql-­‐config-­‐editor.html 2.\nhttp://dev.mysql.com/doc/refman/5.7/en/password-­‐security-­‐user.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"2.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Check the process or task list if the password is visible.\n\nCheck the shell or command history if the password is visible.\n\"\n  tag \"fix\": \"Use -p without password and then enter the password when\nprompted, use a properly\nsecured .my.cnf file, or store authentication information in encrypted format\nin\n.mylogin.cnf.\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-2.2.rb",
        "line": 1
      },
      "id": "M-2.2"
    },
    {
      "title": "1.5 Disable Interactive Login (Scored)",
      "desc": "When created, the MySQL user may have interactive access to the\noperating system, which means that the MySQL user could login to the host as\nany other user would. Preventing the MySQL user from logging in interactively\nmay reduce the impact of a compromised MySQL account.  There is also more\naccountability as accessing the operating system where the MySQL server lies\nwill require the user's own account.  Interactive access by the MySQL user is\nunnecessary and should be disabled.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "1.5",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Execute the following command to assess this\nrecommendation\ngetent passwd mysql | egrep '^.*[\\/bin\\/false|\\/sbin\\/nologin]$'\nLack of output implies a finding.\n",
        "fix": "Perform the following steps to remediate this setting: Execute\none of the following commands in a terminal\nusermod -s /bin/false\nusermod -s /sbin/nologin "
      },
      "code": "control \"M-1.5\" do\n  title \"1.5 Disable Interactive Login (Scored)\"\n  desc  \"When created, the MySQL user may have interactive access to the\noperating system, which means that the MySQL user could login to the host as\nany other user would. Preventing the MySQL user from logging in interactively\nmay reduce the impact of a compromised MySQL account.  There is also more\naccountability as accessing the operating system where the MySQL server lies\nwill require the user's own account.  Interactive access by the MySQL user is\nunnecessary and should be disabled. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"1.5\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Execute the following command to assess this\nrecommendation\ngetent passwd mysql | egrep '^.*[\\\\/bin\\\\/false|\\\\/sbin\\\\/nologin]$'\nLack of output implies a finding.\n\"\n  tag \"fix\": \"Perform the following steps to remediate this setting: Execute\none of the following commands in a terminal\nusermod -s /bin/false\nusermod -s /sbin/nologin \"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-1.5.rb",
        "line": 1
      },
      "id": "M-1.5"
    },
    {
      "title": "3.2 Ensure 'log_bin_basename' Files Have Appropriate Permissions and\nOwnership (Scored)",
      "desc": "MySQL can operate using a variety of log files, each used for\ndifferent purposes.  These are the binary log, error log, slow query log, relay\nlog, and general log.  Because these are files on the host operating system,\nthey are subject to the permissions and ownership structure provided by the\nhost and may be accessible by users other than the MySQL user. Limiting the\naccessibility of these objects will protect the confidentiality, integrity, and\navailability of the MySQL logs.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following steps to assess this recommendation:\nExecute the following SQL statement to determine the Value of log_bin_basename\n\nshow variables like 'log_bin_basename'; Execute the following command at a\nterminal prompt to list all log_bin_basename.*\nfiles\nls <log_bin_basename>.* For each file listed, execute the following command\nls -l <log_bin_basename.nnnnn> | egrep '^-[r|w]{2}-[r|w]{2}----\\s*.*$'\nLack of output implies a finding.\n",
        "fix": "Execute the following command for each log file location\nrequiring corrected permissions\nand ownership:\nchmod 660 <log file>\nchown mysql:mysql <log file>\n"
      },
      "code": "control \"M-3.2\" do\n  title \"3.2 Ensure 'log_bin_basename' Files Have Appropriate Permissions and\nOwnership (Scored)\"\n  desc  \"MySQL can operate using a variety of log files, each used for\ndifferent purposes.  These are the binary log, error log, slow query log, relay\nlog, and general log.  Because these are files on the host operating system,\nthey are subject to the permissions and ownership structure provided by the\nhost and may be accessible by users other than the MySQL user. Limiting the\naccessibility of these objects will protect the confidentiality, integrity, and\navailability of the MySQL logs. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"3.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following steps to assess this recommendation:\nExecute the following SQL statement to determine the Value of log_bin_basename\n\nshow variables like 'log_bin_basename'; Execute the following command at a\nterminal prompt to list all log_bin_basename.*\nfiles\nls <log_bin_basename>.* For each file listed, execute the following command\nls -l <log_bin_basename.nnnnn> | egrep '^-[r|w]{2}-[r|w]{2}----\\\\s*.*$'\nLack of output implies a finding.\n\"\n  tag \"fix\": \"Execute the following command for each log file location\nrequiring corrected permissions\nand ownership:\nchmod 660 <log file>\nchown mysql:mysql <log file>\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-3.2.rb",
        "line": 1
      },
      "id": "M-3.2"
    },
    {
      "title": "2.3 Do Not Reuse User Accounts (Not Scored)",
      "desc": "Database user accounts should not be reused for multiple applications\nor users. Utilizing unique database accounts across applications will reduce\nthe impact of a compromised MySQL account.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "2.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Each user should be linked to one of these system accounts\n\na person\nan application\n",
        "fix": "Add/Remove users so that each user is only used for one specific\npurpose. "
      },
      "code": "control \"M-2.3\" do\n  title \"2.3 Do Not Reuse User Accounts (Not Scored)\"\n  desc  \"Database user accounts should not be reused for multiple applications\nor users. Utilizing unique database accounts across applications will reduce\nthe impact of a compromised MySQL account. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"2.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Each user should be linked to one of these system accounts\n\na person\nan application\n\"\n  tag \"fix\": \"Add/Remove users so that each user is only used for one specific\npurpose. \"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-2.3.rb",
        "line": 1
      },
      "id": "M-2.3"
    },
    {
      "title": "1.4 Verify that 'MYSQL_PWD' Is Not Set (Scored)",
      "desc": "MySQL can read a default database password from an environment\nvariable called MYSQL_PWD. Avoiding use of this environment variable can better\nsafeguard the confidentiality of MySQL credentials. The use of the MYSQL_PWD\nenvironment variable implies the clear text storage of MySQL credentials.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/environment-­‐variables.html 2.\nhttps://blogs.oracle.com/myoraclediary/entry/how_to_check_environment_variabl\nes ",
        "severity": "medium",
        "cis_id": "1.4",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "To assess this recommendation, use the /proc filesystem to\ndetermine if MYSQL_PWD is\ncurrently set for any process\ngrep MYSQL_PWD /proc/*/environ\nThis may return one entry for the process which is executing the grep command.\n\n",
        "fix": "Check which users and/or scripts are setting MYSQL_PWD and change\nthem to use a more\nsecure method.\n",
        "Default Value": "Not set.\n"
      },
      "code": "control \"M-1.4\" do\n  title \"1.4 Verify that 'MYSQL_PWD' Is Not Set (Scored)\"\n  desc  \"MySQL can read a default database password from an environment\nvariable called MYSQL_PWD. Avoiding use of this environment variable can better\nsafeguard the confidentiality of MySQL credentials. The use of the MYSQL_PWD\nenvironment variable implies the clear text storage of MySQL credentials. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/environment-­‐variables.html 2.\nhttps://blogs.oracle.com/myoraclediary/entry/how_to_check_environment_variabl\nes \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"1.4\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"To assess this recommendation, use the /proc filesystem to\ndetermine if MYSQL_PWD is\ncurrently set for any process\ngrep MYSQL_PWD /proc/*/environ\nThis may return one entry for the process which is executing the grep command.\n\n\"\n  tag \"fix\": \"Check which users and/or scripts are setting MYSQL_PWD and change\nthem to use a more\nsecure method.\n\"\n  tag \"Default Value\": \"Not set.\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-1.4.rb",
        "line": 1
      },
      "id": "M-1.4"
    },
    {
      "title": "6.12 Make sure the audit plugin can't be unloaded (Scored)",
      "desc": "Set audit_log to FORCE_PLUS_PERMANENT This makes disables unloading on\nthe plugin.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#option_mysqld_audit-­‐log ",
        "severity": "medium",
        "cis_id": "6.12",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "To assess this recommendation, execute the following SQL\nstatement:\nSELECT LOAD_OPTION FROM information_schema.plugins WHERE\nPLUGIN_NAME='audit_log';\nThe result must be FORCE_PLUS_PERMANENT\n",
        "fix": "To remediate this setting, follow these steps: Open the MySQL\nconfiguration file (my.cnf) Ensure the following line is found in the mysqld\nsection\naudit_log = 'FORCE_PLUS_PERMANENT'\n",
        "Default Value": "ON\n"
      },
      "code": "control \"M-6.12\" do\n  title \"6.12 Make sure the audit plugin can't be unloaded (Scored)\"\n  desc  \"Set audit_log to FORCE_PLUS_PERMANENT This makes disables unloading on\nthe plugin. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#option_mysqld_audit-­‐log \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.12\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"To assess this recommendation, execute the following SQL\nstatement:\nSELECT LOAD_OPTION FROM information_schema.plugins WHERE\nPLUGIN_NAME='audit_log';\nThe result must be FORCE_PLUS_PERMANENT\n\"\n  tag \"fix\": \"To remediate this setting, follow these steps: Open the MySQL\nconfiguration file (my.cnf) Ensure the following line is found in the mysqld\nsection\naudit_log = 'FORCE_PLUS_PERMANENT'\n\"\n  tag \"Default Value\": \"ON\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-6.12.rb",
        "line": 1
      },
      "id": "M-6.12"
    },
    {
      "title": "5.8 Ensure 'repl_slave_priv' Is Not Set to 'Y' for Non-­‐Slave Users\n(Scored)",
      "desc": "The REPLICATION SLAVE privilege governs whether a given user (in the\ncontext of the master server) can request updates that have been made on the\nmaster server. The REPLICATION SLAVE privilege allows a principal to fetch\nbinlog files containing all data changing statements and/or changes in table\ndata from the master. This may be used by an attacker to read/fetch sensitive\ndata from MySQL.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/privileges-­‐\nprovided.html#priv_replication-­‐slave ",
        "severity": "medium",
        "cis_id": "5.8",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to audit this setting:\n\nSELECT user, host FROM mysql.user WHERE Repl_slave_priv = 'Y';\nEnsure only accounts designated for slave users are granted this privilege.\n",
        "fix": "Perform the following steps to remediate this setting: Enumerate\nthe non-­‐slave users found in the result set of the audit procedure For each\nuser, issue the following SQL statement (replace '<user>' with the non-­‐\nslave user):\nREVOKE REPLICATION SLAVE ON *.* FROM <user>; Use the REVOKE statement to remove\nthe SUPER privilege from users who shouldn't have\nit.\n"
      },
      "code": "control \"M-5.8\" do\n  title \"5.8 Ensure 'repl_slave_priv' Is Not Set to 'Y' for Non-­‐Slave Users\n(Scored)\"\n  desc  \"The REPLICATION SLAVE privilege governs whether a given user (in the\ncontext of the master server) can request updates that have been made on the\nmaster server. The REPLICATION SLAVE privilege allows a principal to fetch\nbinlog files containing all data changing statements and/or changes in table\ndata from the master. This may be used by an attacker to read/fetch sensitive\ndata from MySQL. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/privileges-­‐\nprovided.html#priv_replication-­‐slave \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"5.8\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to audit this setting:\n\nSELECT user, host FROM mysql.user WHERE Repl_slave_priv = 'Y';\nEnsure only accounts designated for slave users are granted this privilege.\n\"\n  tag \"fix\": \"Perform the following steps to remediate this setting: Enumerate\nthe non-­‐slave users found in the result set of the audit procedure For each\nuser, issue the following SQL statement (replace '<user>' with the non-­‐\nslave user):\nREVOKE REPLICATION SLAVE ON *.* FROM <user>; Use the REVOKE statement to remove\nthe SUPER privilege from users who shouldn't have\nit.\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-5.8.rb",
        "line": 1
      },
      "id": "M-5.8"
    },
    {
      "title": "3.6 Ensure 'general_log_file' Has Appropriate Permissions and\nOwnership (Scored)",
      "desc": "MySQL can operate using a variety of log files, each used for\ndifferent purposes.  These are the binary log, error log, slow query log, relay\nlog, audit log and general log.  Because these are files on the host operating\nsystem, they are subject to the permissions and ownership structure provided by\nthe host and may be accessible by users other than the MySQL user. Limiting the\naccessibility of these objects will protect the confidentiality, integrity, and\navailability of the MySQL logs.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.6",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following steps to assess this recommendation:\nExecute the following SQL statement to determine the Value of general_log_file\n\nshow variables like 'general_log_file'; Execute the following command at a\nterminal prompt to list all general_log_file.*\nfiles\nls <general_log_file>.* For each file listed, execute the following command\nls -l <general_log_file> | egrep '^-[r|w]{2}-[r|w]{2}----\\s*.*$'\nLack of output implies a finding.\n",
        "fix": "Execute the following command for each log file location\nrequiring corrected permissions\nand ownership:\nchmod 660 <log file>\nchown mysql:mysql <log file>\n"
      },
      "code": "control \"M-3.6\" do\n  title \"3.6 Ensure 'general_log_file' Has Appropriate Permissions and\nOwnership (Scored)\"\n  desc  \"MySQL can operate using a variety of log files, each used for\ndifferent purposes.  These are the binary log, error log, slow query log, relay\nlog, audit log and general log.  Because these are files on the host operating\nsystem, they are subject to the permissions and ownership structure provided by\nthe host and may be accessible by users other than the MySQL user. Limiting the\naccessibility of these objects will protect the confidentiality, integrity, and\navailability of the MySQL logs. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"3.6\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following steps to assess this recommendation:\nExecute the following SQL statement to determine the Value of general_log_file\n\nshow variables like 'general_log_file'; Execute the following command at a\nterminal prompt to list all general_log_file.*\nfiles\nls <general_log_file>.* For each file listed, execute the following command\nls -l <general_log_file> | egrep '^-[r|w]{2}-[r|w]{2}----\\\\s*.*$'\nLack of output implies a finding.\n\"\n  tag \"fix\": \"Execute the following command for each log file location\nrequiring corrected permissions\nand ownership:\nchmod 660 <log file>\nchown mysql:mysql <log file>\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-3.6.rb",
        "line": 1
      },
      "id": "M-3.6"
    },
    {
      "title": "4.9 Ensure 'sql_mode' Contains 'STRICT_ALL_TABLES' (Scored)",
      "desc": "When data changing statements are made (i.e. INSERT, UPDATE), MySQL\ncan handle invalid or missing values differently depending on whether strict\nSQL mode is enabled.  When strict SQL mode is enabled, data may not be\ntruncated or otherwise 'adjusted' to make the data changing statement work.\nWithout strict mode the server tries to do proceed with the action when an\nerror might have been a more secure choice. For example, by default MySQL will\ntruncate data if it does not fit in a field, which can lead to unknown\nbehavior, or be leveraged by an attacker to circumvent data validation.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/server-­‐sql-­‐mode.html ",
        "severity": "medium",
        "cis_id": "4.9",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "To audit for this recommendation execute the following\nquery:\nSHOW VARIABLES LIKE 'sql_mode';\nEnsure that STRICT_ALL_TABLES is in the list returned.\n",
        "fix": "Perform the following actions to remediate this setting: Add\nSTRICT_ALL_TABLES to the sql_mode in the server's configuration file\n"
      },
      "code": "control \"M-4.9\" do\n  title \"4.9 Ensure 'sql_mode' Contains 'STRICT_ALL_TABLES' (Scored)\"\n  desc  \"When data changing statements are made (i.e. INSERT, UPDATE), MySQL\ncan handle invalid or missing values differently depending on whether strict\nSQL mode is enabled.  When strict SQL mode is enabled, data may not be\ntruncated or otherwise 'adjusted' to make the data changing statement work.\nWithout strict mode the server tries to do proceed with the action when an\nerror might have been a more secure choice. For example, by default MySQL will\ntruncate data if it does not fit in a field, which can lead to unknown\nbehavior, or be leveraged by an attacker to circumvent data validation. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/server-­‐sql-­‐mode.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.9\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"To audit for this recommendation execute the following\nquery:\nSHOW VARIABLES LIKE 'sql_mode';\nEnsure that STRICT_ALL_TABLES is in the list returned.\n\"\n  tag \"fix\": \"Perform the following actions to remediate this setting: Add\nSTRICT_ALL_TABLES to the sql_mode in the server's configuration file\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-4.9.rb",
        "line": 1
      },
      "id": "M-4.9"
    },
    {
      "title": "6.4 Ensure 'log-­‐raw' Is Set to 'OFF' (Scored)",
      "desc": "The log-­‐raw MySQL option determines whether passwords are rewritten\nby the server so as not to appear in log files as plain text.  If log-­‐raw is\nenabled, then passwords are written to the various log files (general query\nlog, slow query log, and binary log) in plain text. With raw logging of\npasswords enabled someone with access to the log files might see plain text\npasswords.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/password-­‐logging.html\n2. http://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_log-­‐raw ",
        "severity": "medium",
        "cis_id": "6.4",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following actions to assess this\nrecommendation: Open the MySQL configuration file (my.cnf)\nEnsure the log-raw entry is present\nEnsure the log-raw entry is set to OFF\n",
        "fix": "Perform the following actions to remediate this setting:\nOpen the MySQL configuration file (my.cnf)\nFind the log-raw entry and set it as follows\nlog-raw = OFF\n",
        "Default Value": "OFF\n"
      },
      "code": "control \"M-6.4\" do\n  title \"6.4 Ensure 'log-­‐raw' Is Set to 'OFF' (Scored)\"\n  desc  \"The log-­‐raw MySQL option determines whether passwords are rewritten\nby the server so as not to appear in log files as plain text.  If log-­‐raw is\nenabled, then passwords are written to the various log files (general query\nlog, slow query log, and binary log) in plain text. With raw logging of\npasswords enabled someone with access to the log files might see plain text\npasswords. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/password-­‐logging.html\n2. http://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_log-­‐raw \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.4\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following actions to assess this\nrecommendation: Open the MySQL configuration file (my.cnf)\nEnsure the log-raw entry is present\nEnsure the log-raw entry is set to OFF\n\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\nOpen the MySQL configuration file (my.cnf)\nFind the log-raw entry and set it as follows\nlog-raw = OFF\n\"\n  tag \"Default Value\": \"OFF\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-6.4.rb",
        "line": 1
      },
      "id": "M-6.4"
    },
    {
      "title": "5.3 Ensure 'process_priv' Is Not Set to 'Y' for Non-­‐Administrative\nUsers (Scored)",
      "desc": "The PROCESS privilege found in the mysql.user table determines whether\na given user can see statement execution information for all sessions. The\nPROCESS privilege allows principals to view currently executing MySQL\nstatements beyond their own, including statements used to manage passwords.\nThis may be leveraged by an attacker to compromise MySQL or to gain access to\npotentially sensitive data.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/privileges-­‐provided.html#priv_process ",
        "severity": "medium",
        "cis_id": "5.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Execute the following SQL statement to audit this setting:\n\nselect user, host from mysql.user where Process_priv = 'Y';\nEnsure only administrative users are returned in the result set.\n",
        "fix": "Perform the following steps to remediate this setting: Enumerate\nthe non-­‐administrative users found in the result set of the audit\nprocedure For each user, issue the following SQL statement (replace '<user>'\nwith the non-­‐\nadministrative user:\nREVOKE PROCESS ON *.* FROM '<user>';\n"
      },
      "code": "control \"M-5.3\" do\n  title \"5.3 Ensure 'process_priv' Is Not Set to 'Y' for Non-­‐Administrative\nUsers (Scored)\"\n  desc  \"The PROCESS privilege found in the mysql.user table determines whether\na given user can see statement execution information for all sessions. The\nPROCESS privilege allows principals to view currently executing MySQL\nstatements beyond their own, including statements used to manage passwords.\nThis may be leveraged by an attacker to compromise MySQL or to gain access to\npotentially sensitive data. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/privileges-­‐provided.html#priv_process \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"5.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Execute the following SQL statement to audit this setting:\n\nselect user, host from mysql.user where Process_priv = 'Y';\nEnsure only administrative users are returned in the result set.\n\"\n  tag \"fix\": \"Perform the following steps to remediate this setting: Enumerate\nthe non-­‐administrative users found in the result set of the audit\nprocedure For each user, issue the following SQL statement (replace '<user>'\nwith the non-­‐\nadministrative user:\nREVOKE PROCESS ON *.* FROM '<user>';\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-5.3.rb",
        "line": 1
      },
      "id": "M-5.3"
    },
    {
      "title": "4.2 Ensure the 'test' Database Is Not Installed (Scored)",
      "desc": "The default MySQL installation comes with an unused database called\ntest. It is recommended that the test database be dropped. The test database\ncan be accessed by all users and can be used to consume system resources.\nDropping the test database will reduce the attack surface of the MySQL server.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/mysql-­‐secure-­‐installation.html ",
        "severity": "medium",
        "cis_id": "4.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to determine if the\ntest database is present:\nSHOW DATABASES LIKE 'test';\nThe above SQL statement will return zero rows\n",
        "fix": "Execute the following SQL statement to drop the test database:\nDROP DATABASE 'test';\nNote: mysql_secure_installation performs this operation as well as other\nsecurity-­‐\nrelated activities.\n"
      },
      "code": "control \"M-4.2\" do\n  title \"4.2 Ensure the 'test' Database Is Not Installed (Scored)\"\n  desc  \"The default MySQL installation comes with an unused database called\ntest. It is recommended that the test database be dropped. The test database\ncan be accessed by all users and can be used to consume system resources.\nDropping the test database will reduce the attack surface of the MySQL server. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/mysql-­‐secure-­‐installation.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to determine if the\ntest database is present:\nSHOW DATABASES LIKE 'test';\nThe above SQL statement will return zero rows\n\"\n  tag \"fix\": \"Execute the following SQL statement to drop the test database:\nDROP DATABASE 'test';\nNote: mysql_secure_installation performs this operation as well as other\nsecurity-­‐\nrelated activities.\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-4.2.rb",
        "line": 1
      },
      "id": "M-4.2"
    },
    {
      "title": "7.5 Ensure Passwords Are Set for All MySQL Accounts (Scored)",
      "desc": "Blank passwords allow a user to login without using a password.\nWithout a password only knowing the username and the list of allowed hosts will\nallow someone to connect to the server and assume the identity of the user.\nThis, in effect, bypasses authentication mechanisms.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "7.5",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL query to determine if any users\nhave a blank password:\nSELECT User,host\nFROM mysql.user\nWHERE (plugin IN('mysql_native_password', 'mysql_old_password')\nAND (LENGTH(Password) = 0\nOR Password IS NULL))\nOR (plugin='sha256_password' AND LENGTH(authentication_string) = 0);\nNo rows will be returned if all accounts have a password set.\n",
        "fix": "For each row returned from the audit procedure, set a password\nfor the given user using\nthe following statement (as an example):\nSET PASSWORD FOR <user>@'<host>' = PASSWORD('<clear password>')\nNOTE: Replace <user>, <host>, and <clear password> with appropriate values. "
      },
      "code": "control \"M-7.5\" do\n  title \"7.5 Ensure Passwords Are Set for All MySQL Accounts (Scored)\"\n  desc  \"Blank passwords allow a user to login without using a password.\nWithout a password only knowing the username and the list of allowed hosts will\nallow someone to connect to the server and assume the identity of the user.\nThis, in effect, bypasses authentication mechanisms. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.5\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL query to determine if any users\nhave a blank password:\nSELECT User,host\nFROM mysql.user\nWHERE (plugin IN('mysql_native_password', 'mysql_old_password')\nAND (LENGTH(Password) = 0\nOR Password IS NULL))\nOR (plugin='sha256_password' AND LENGTH(authentication_string) = 0);\nNo rows will be returned if all accounts have a password set.\n\"\n  tag \"fix\": \"For each row returned from the audit procedure, set a password\nfor the given user using\nthe following statement (as an example):\nSET PASSWORD FOR <user>@'<host>' = PASSWORD('<clear password>')\nNOTE: Replace <user>, <host>, and <clear password> with appropriate values. \"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-7.5.rb",
        "line": 1
      },
      "id": "M-7.5"
    },
    {
      "title": "3.9 Ensure 'audit_log_file' has Appropriate Permissions and Ownership\n(Scored)",
      "desc": "MySQL can operate using a variety of log files, each used for\ndifferent purposes. These are the binary log, error log, slow query log, relay\nlog, audit log and general log. Because these are files on the host operating\nsystem, they are subject to the permissions and ownership structure provided by\nthe host and may be accessible by users other than the MySQL user. Limiting the\naccessibility of these objects will protect the confidentiality, integrity, and\navailability of the MySQL logs.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.9",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "To assess this recommendation, execute the following SQL\nstatement to discover the\naudit_log_file value:\nshow global variables where variable_name='audit_log_file'; NOTE: If you see\nthe audit file name but no path, the default path will be the path assigned\nto the datadir variable.\nThen, execute the following command at a terminal prompt (using the discovered\n\naudit_log_file value):\nls -l <audit_log_file> | egrep '^-rw[-x]rw[-x][-r][-w][-x][ \\t]*[0-9][\n\\t]*mysql[\n\\t]*mysql.*$'\n",
        "fix": "Execute the following commands for the audit_log_file discovered\nin the audit\nprocedure:\nchmod 660 <audit_log_file>\nchown mysql:mysql <audit_log_file>\n"
      },
      "code": "control \"M-3.9\" do\n  title \"3.9 Ensure 'audit_log_file' has Appropriate Permissions and Ownership\n(Scored)\"\n  desc  \"MySQL can operate using a variety of log files, each used for\ndifferent purposes. These are the binary log, error log, slow query log, relay\nlog, audit log and general log. Because these are files on the host operating\nsystem, they are subject to the permissions and ownership structure provided by\nthe host and may be accessible by users other than the MySQL user. Limiting the\naccessibility of these objects will protect the confidentiality, integrity, and\navailability of the MySQL logs. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"3.9\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"To assess this recommendation, execute the following SQL\nstatement to discover the\naudit_log_file value:\nshow global variables where variable_name='audit_log_file'; NOTE: If you see\nthe audit file name but no path, the default path will be the path assigned\nto the datadir variable.\nThen, execute the following command at a terminal prompt (using the discovered\n\naudit_log_file value):\nls -l <audit_log_file> | egrep '^-rw[-x]rw[-x][-r][-w][-x][ \\\\t]*[0-9][\n\\\\t]*mysql[\n\\\\t]*mysql.*$'\n\"\n  tag \"fix\": \"Execute the following commands for the audit_log_file discovered\nin the audit\nprocedure:\nchmod 660 <audit_log_file>\nchown mysql:mysql <audit_log_file>\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-3.9.rb",
        "line": 1
      },
      "id": "M-3.9"
    },
    {
      "title": "5.7 Ensure 'grant_priv' Is Not Set to 'Y' for Non-­‐Administrative\nUsers (Scored)",
      "desc": "The GRANT OPTION privilege exists in different contexts (mysql.user,\nmysql.db) for the purpose of governing the ability of a privileged user to\nmanipulate the privileges of other users. The GRANT privilege allows a\nprincipal to grant other principals additional privileges. This may be used by\nan attacker to compromise MySQL.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/privileges-­‐provided.html#priv_grant-­‐\noption ",
        "severity": "medium",
        "cis_id": "5.7",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statements to audit this\nsetting:\nSELECT user, host FROM mysql.user WHERE Grant_priv = 'Y';\nSELECT user, host FROM mysql.db WHERE Grant_priv = 'Y';\nEnsure only administrative users are returned in the result set.\n",
        "fix": "Perform the following steps to remediate this setting: Enumerate\nthe non-­‐administrative users found in the result sets of the audit\nprocedure For each user, issue the following SQL statement (replace '<user>'\nwith the non-­‐\nadministrative user:\nREVOKE GRANT OPTION ON *.* FROM <user>;\n"
      },
      "code": "control \"M-5.7\" do\n  title \"5.7 Ensure 'grant_priv' Is Not Set to 'Y' for Non-­‐Administrative\nUsers (Scored)\"\n  desc  \"The GRANT OPTION privilege exists in different contexts (mysql.user,\nmysql.db) for the purpose of governing the ability of a privileged user to\nmanipulate the privileges of other users. The GRANT privilege allows a\nprincipal to grant other principals additional privileges. This may be used by\nan attacker to compromise MySQL. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/privileges-­‐provided.html#priv_grant-­‐\noption \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"5.7\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statements to audit this\nsetting:\nSELECT user, host FROM mysql.user WHERE Grant_priv = 'Y';\nSELECT user, host FROM mysql.db WHERE Grant_priv = 'Y';\nEnsure only administrative users are returned in the result set.\n\"\n  tag \"fix\": \"Perform the following steps to remediate this setting: Enumerate\nthe non-­‐administrative users found in the result sets of the audit\nprocedure For each user, issue the following SQL statement (replace '<user>'\nwith the non-­‐\nadministrative user:\nREVOKE GRANT OPTION ON *.* FROM <user>;\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-5.7.rb",
        "line": 1
      },
      "id": "M-5.7"
    },
    {
      "title": "9.3 Ensure 'master_info_repository' Is Set to 'TABLE' (Scored)",
      "desc": "The master_info_repository setting determines to where a slave logs\nmaster status and connection information.  The options are FILE or TABLE.  Note\nalso that this setting is associated with the sync_master_info setting as well.\nThe password which the client uses is stored in the master info repository,\nwhich by default is a plaintext file. The TABLE master info repository is a bit\nsafer, but with filesystem access it's still possible to gain access to the\npassword the slave is using.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/replication-­‐options-­‐\nslave.html#sysvar_master_info_repository ",
        "severity": "medium",
        "cis_id": "9.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Execute the following SQL statement to assess this\nrecommendation:\nSHOW GLOBAL VARIABLES LIKE 'master_info_repository';\nThe result should be TABLE instead of FILE.\nNOTE: There also should not be a master.info file in the datadir.\n",
        "fix": "Perform the following actions to remediate this setting: Open the\nMySQL configuration file (my.cnf) Locate master_info_repository Set the\nmaster_info_repository value to TABLE\nNOTE: If master_info_repository does not exist, add it to the configuration\nfile.\n",
        "Default Value": "FILE\n"
      },
      "code": "control \"M-9.3\" do\n  title \"9.3 Ensure 'master_info_repository' Is Set to 'TABLE' (Scored)\"\n  desc  \"The master_info_repository setting determines to where a slave logs\nmaster status and connection information.  The options are FILE or TABLE.  Note\nalso that this setting is associated with the sync_master_info setting as well.\nThe password which the client uses is stored in the master info repository,\nwhich by default is a plaintext file. The TABLE master info repository is a bit\nsafer, but with filesystem access it's still possible to gain access to the\npassword the slave is using. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/replication-­‐options-­‐\nslave.html#sysvar_master_info_repository \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"9.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Execute the following SQL statement to assess this\nrecommendation:\nSHOW GLOBAL VARIABLES LIKE 'master_info_repository';\nThe result should be TABLE instead of FILE.\nNOTE: There also should not be a master.info file in the datadir.\n\"\n  tag \"fix\": \"Perform the following actions to remediate this setting: Open the\nMySQL configuration file (my.cnf) Locate master_info_repository Set the\nmaster_info_repository value to TABLE\nNOTE: If master_info_repository does not exist, add it to the configuration\nfile.\n\"\n  tag \"Default Value\": \"FILE\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-9.3.rb",
        "line": 1
      },
      "id": "M-9.3"
    },
    {
      "title": "7.1 Ensure 'old_passwords' Is Not Set to '1' (Scored)",
      "desc": "This variable controls the password hashing method used by the\nPASSWORD() function and for the IDENTIFIED BY clause of the CREATE USER and\nGRANT statements. The value can be one of the following: 0 -­‐ authenticate\nwith the mysql_native_password plugin 1 -­‐ authenticate with the\nmysql_old_password plugin 2 -­‐ authenticate with the sha256_password plugin\nThe mysql_old_password plugin leverages a very weak hashing algorithm that can\nbe quickly brute forced using an offline dictionary attack. See\nCVE-­‐2003-­‐1480 for additional details.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/server-­‐system-­‐\nvariables.html#sysvar_old_passwords 2. CVE-­‐2003-­‐1480 ",
        "severity": "medium",
        "cis_id": "7.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to assess this\nrecommendation:\nSHOW VARIABLES WHERE Variable_name = 'old_passwords';\nEnsure the Value field is not set to 1.\n",
        "fix": "Configure mysql to leverage the mysql_native_password or\nsha256_password plugin. For\nmore information, see:\nhttp://dev.mysql.com/doc/refman/5.6/en/password-­‐hashing.html\nhttp://dev.mysql.com/doc/refman/5.6/en/sha256-­‐authentication-­‐plugin.html\n\n",
        "Default Value": "0\n"
      },
      "code": "control \"M-7.1\" do\n  title \"7.1 Ensure 'old_passwords' Is Not Set to '1' (Scored)\"\n  desc  \"This variable controls the password hashing method used by the\nPASSWORD() function and for the IDENTIFIED BY clause of the CREATE USER and\nGRANT statements. The value can be one of the following: 0 -­‐ authenticate\nwith the mysql_native_password plugin 1 -­‐ authenticate with the\nmysql_old_password plugin 2 -­‐ authenticate with the sha256_password plugin\nThe mysql_old_password plugin leverages a very weak hashing algorithm that can\nbe quickly brute forced using an offline dictionary attack. See\nCVE-­‐2003-­‐1480 for additional details. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/server-­‐system-­‐\nvariables.html#sysvar_old_passwords 2. CVE-­‐2003-­‐1480 \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to assess this\nrecommendation:\nSHOW VARIABLES WHERE Variable_name = 'old_passwords';\nEnsure the Value field is not set to 1.\n\"\n  tag \"fix\": \"Configure mysql to leverage the mysql_native_password or\nsha256_password plugin. For\nmore information, see:\nhttp://dev.mysql.com/doc/refman/5.6/en/password-­‐hashing.html\nhttp://dev.mysql.com/doc/refman/5.6/en/sha256-­‐authentication-­‐plugin.html\n\n\"\n  tag \"Default Value\": \"0\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-7.1.rb",
        "line": 1
      },
      "id": "M-7.1"
    },
    {
      "title": "8.2 Ensure 'ssl_type' Is Set to 'ANY', 'X509', or 'SPECIFIED' for All\nRemote Users (Scored)",
      "desc": "All network traffic must use SSL/TLS when traveling over untrusted\nnetworks. SSL/TLS should be enforced on a per-­‐user basis for users which\nenter the system through the network. The SSL/TLS-­‐protected MySQL protocol\nhelps to prevent eavesdropping and man-­‐in-­‐the-­‐ middle attacks.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/ssl-­‐connections.html\n2. http://dev.mysql.com/doc/refman/5.7/en/grant.html ",
        "severity": "medium",
        "cis_id": "8.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statements to assess this\nrecommendation:\nSELECT user, host, ssl_type FROM mysql.user\nWHERE NOT HOST IN ('::1', '127.0.0.1', 'localhost');\nEnsure the ssl_type for each user returned is equal to ANY, X509, or SPECIFIED.\n\nNOTE: have_openssl is an alias for have_ssl as of MySQL 5.0.38.  MySQL can be\nbuild\nwith OpenSSL or YaSSL.\n",
        "fix": "Use the GRANT statement to require the use of SSL:\nGRANT USAGE ON *.* TO 'my_user'@'app1.example.com' REQUIRE SSL; Note that\nREQUIRE SSL only enforces SSL. There are options like REQUIRE X509, REQUIRE\nISSUER, REQUIRE SUBJECT which can be used to further restrict connection\noptions.\n",
        "Default Value": "Not enforced (ssl_type is empty)\n"
      },
      "code": "control \"M-8.2\" do\n  title \"8.2 Ensure 'ssl_type' Is Set to 'ANY', 'X509', or 'SPECIFIED' for All\nRemote Users (Scored)\"\n  desc  \"All network traffic must use SSL/TLS when traveling over untrusted\nnetworks. SSL/TLS should be enforced on a per-­‐user basis for users which\nenter the system through the network. The SSL/TLS-­‐protected MySQL protocol\nhelps to prevent eavesdropping and man-­‐in-­‐the-­‐ middle attacks. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/ssl-­‐connections.html\n2. http://dev.mysql.com/doc/refman/5.7/en/grant.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"8.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statements to assess this\nrecommendation:\nSELECT user, host, ssl_type FROM mysql.user\nWHERE NOT HOST IN ('::1', '127.0.0.1', 'localhost');\nEnsure the ssl_type for each user returned is equal to ANY, X509, or SPECIFIED.\n\nNOTE: have_openssl is an alias for have_ssl as of MySQL 5.0.38.  MySQL can be\nbuild\nwith OpenSSL or YaSSL.\n\"\n  tag \"fix\": \"Use the GRANT statement to require the use of SSL:\nGRANT USAGE ON *.* TO 'my_user'@'app1.example.com' REQUIRE SSL; Note that\nREQUIRE SSL only enforces SSL. There are options like REQUIRE X509, REQUIRE\nISSUER, REQUIRE SUBJECT which can be used to further restrict connection\noptions.\n\"\n  tag \"Default Value\": \"Not enforced (ssl_type is empty)\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-8.2.rb",
        "line": 1
      },
      "id": "M-8.2"
    },
    {
      "title": "4.6 Ensure '-­‐-­‐skip-­‐symbolic-­‐links' Is Enabled (Scored)",
      "desc": "The symbolic-­‐links and skip-­‐symbolic-­‐links options for MySQL\ndetermine whether symbolic link support is available.  When use of symbolic\nlinks are enabled, they have different effects depending on the host platform.\nWhen symbolic links are disabled, then symbolic links stored in files or\nentries in tables are not used by the database. Prevents sym links being used\nfor data base files. This is especially important when MySQL is executing as\nroot as arbitrary files may be overwritten.  The symbolic-­‐links option might\nallow someone to direct actions by to MySQL server to other files and/or\ndirectories.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/symbolic-­‐links.html\n2. http://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_symbolic-­‐links ",
        "severity": "medium",
        "cis_id": "4.6",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to assess this\nrecommendation:\nSHOW variables LIKE 'have_symlink';\nEnsure the Value returned is DISABLED.\n",
        "fix": "Perform the following actions to remediate this setting: Open the\nMySQL configuration file (my.cnf)\nLocate skip_symbolic_links in the configuration\nSet the skip_symbolic_links to YES\nNOTE: If skip_symbolic_links does not exist, add it to the configuration file\nin the mysqld\nsection.\n"
      },
      "code": "control \"M-4.6\" do\n  title \"4.6 Ensure '-­‐-­‐skip-­‐symbolic-­‐links' Is Enabled (Scored)\"\n  desc  \"The symbolic-­‐links and skip-­‐symbolic-­‐links options for MySQL\ndetermine whether symbolic link support is available.  When use of symbolic\nlinks are enabled, they have different effects depending on the host platform.\nWhen symbolic links are disabled, then symbolic links stored in files or\nentries in tables are not used by the database. Prevents sym links being used\nfor data base files. This is especially important when MySQL is executing as\nroot as arbitrary files may be overwritten.  The symbolic-­‐links option might\nallow someone to direct actions by to MySQL server to other files and/or\ndirectories. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/symbolic-­‐links.html\n2. http://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_symbolic-­‐links \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.6\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to assess this\nrecommendation:\nSHOW variables LIKE 'have_symlink';\nEnsure the Value returned is DISABLED.\n\"\n  tag \"fix\": \"Perform the following actions to remediate this setting: Open the\nMySQL configuration file (my.cnf)\nLocate skip_symbolic_links in the configuration\nSet the skip_symbolic_links to YES\nNOTE: If skip_symbolic_links does not exist, add it to the configuration file\nin the mysqld\nsection.\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-4.6.rb",
        "line": 1
      },
      "id": "M-4.6"
    },
    {
      "title": "3.8 Ensure Plugin Directory Has Appropriate Permissions and Ownership\n(Scored)",
      "desc": "The plugin directory is the location of the MySQL plugins. Plugins are\nstorage engines or user defined functions (UDFs). Limiting the accessibility of\nthese objects will protect the confidentiality, integrity, and availability of\nthe MySQL database.  If someone can modify plugins then these plugins might be\nloaded when the server starts and the code will get executed.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/install-­‐plugin.html ",
        "severity": "medium",
        "cis_id": "3.8",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "To assess this recommendation, execute the following SQL\nstatement to discover the Valuef plugin_dir:\nshow variables where variable_name = 'plugin_dir';\nThen, execute the following command at a terminal prompt (using the discovered\n\nplugin_dir Value) to determine the permissions and ownership.\nls -l <plugin_dir Value>/.. | egrep '^drwxr[-w]xr[-w]x[ \\t]*[0-9][ \\t]*mysql[\n\n\\t]*mysql.*plugin.*$'\nLack of output implies a finding.\nNOTE: Permissions are intended to be either 775 or 755.\n",
        "fix": "To remediate these settings, execute the following commands at a\nterminal prompt using\nthe plugin_dir Value from the audit procedure.\nchmod 775 <plugin_dir Value> (or use 755)\nchown mysql:mysql <plugin_dir Value>\n"
      },
      "code": "control \"M-3.8\" do\n  title \"3.8 Ensure Plugin Directory Has Appropriate Permissions and Ownership\n(Scored)\"\n  desc  \"The plugin directory is the location of the MySQL plugins. Plugins are\nstorage engines or user defined functions (UDFs). Limiting the accessibility of\nthese objects will protect the confidentiality, integrity, and availability of\nthe MySQL database.  If someone can modify plugins then these plugins might be\nloaded when the server starts and the code will get executed. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/install-­‐plugin.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"3.8\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"To assess this recommendation, execute the following SQL\nstatement to discover the Valuef plugin_dir:\nshow variables where variable_name = 'plugin_dir';\nThen, execute the following command at a terminal prompt (using the discovered\n\nplugin_dir Value) to determine the permissions and ownership.\nls -l <plugin_dir Value>/.. | egrep '^drwxr[-w]xr[-w]x[ \\\\t]*[0-9][ \\\\t]*mysql[\n\n\\\\t]*mysql.*plugin.*$'\nLack of output implies a finding.\nNOTE: Permissions are intended to be either 775 or 755.\n\"\n  tag \"fix\": \"To remediate these settings, execute the following commands at a\nterminal prompt using\nthe plugin_dir Value from the audit procedure.\nchmod 775 <plugin_dir Value> (or use 755)\nchown mysql:mysql <plugin_dir Value>\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-3.8.rb",
        "line": 1
      },
      "id": "M-3.8"
    },
    {
      "title": "5.6 Ensure 'create_user_priv' Is Not Set to 'Y' for\nNon-­‐Administrative Users (Scored)",
      "desc": "The CREATE USER privilege governs the right of a given user to add or\nremove users, change existing users' names, or revoke existing users'\nprivileges. Reducing the number of users granted the CREATE USER right\nminimizes the number of users able to add/drop users, alter existing users'\nnames, and manipulate existing users' privileges.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "5.6",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to audit this setting:\n\nSELECT user, host FROM mysql.user WHERE Create_user_priv = 'Y';\nEnsure only administrative users are returned in the result set.\n",
        "fix": "Perform the following steps to remediate this setting: Enumerate\nthe non-­‐administrative users found in the result set of the audit\nprocedure For each user, issue the following SQL statement (replace '<user>'\nwith the non-­‐\nadministrative user):\nREVOKE CREATE USER ON *.* FROM '<user>';\n"
      },
      "code": "control \"M-5.6\" do\n  title \"5.6 Ensure 'create_user_priv' Is Not Set to 'Y' for\nNon-­‐Administrative Users (Scored)\"\n  desc  \"The CREATE USER privilege governs the right of a given user to add or\nremove users, change existing users' names, or revoke existing users'\nprivileges. Reducing the number of users granted the CREATE USER right\nminimizes the number of users able to add/drop users, alter existing users'\nnames, and manipulate existing users' privileges. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"5.6\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to audit this setting:\n\nSELECT user, host FROM mysql.user WHERE Create_user_priv = 'Y';\nEnsure only administrative users are returned in the result set.\n\"\n  tag \"fix\": \"Perform the following steps to remediate this setting: Enumerate\nthe non-­‐administrative users found in the result set of the audit\nprocedure For each user, issue the following SQL statement (replace '<user>'\nwith the non-­‐\nadministrative user):\nREVOKE CREATE USER ON *.* FROM '<user>';\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-5.6.rb",
        "line": 1
      },
      "id": "M-5.6"
    },
    {
      "title": "6.1 Ensure 'log_error' Is Not Empty (Scored)",
      "desc": "The error log contains information about events such as mysqld\nstarting and stopping, when a table needs to be checked or repaired, and,\ndepending on the host operating system, stack traces when mysqld fails.\nEnabling error logging may increase the ability to detect malicious attempts\nagainst MySQL, and other critical messages, such as if the error log is not\nenabled then connection error might go unnoticed.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/error-­‐log.html ",
        "severity": "medium",
        "cis_id": "6.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to audit this setting:\n\nSHOW variables LIKE 'log_error';\nEnsure the Value returned is not empty.\n",
        "fix": "Perform the following actions to remediate this setting: Open the\nMySQL configuration file (my.cnf or my.ini) Set the log-error option to the\npath for the error log\n"
      },
      "code": "control \"M-6.1\" do\n  title \"6.1 Ensure 'log_error' Is Not Empty (Scored)\"\n  desc  \"The error log contains information about events such as mysqld\nstarting and stopping, when a table needs to be checked or repaired, and,\ndepending on the host operating system, stack traces when mysqld fails.\nEnabling error logging may increase the ability to detect malicious attempts\nagainst MySQL, and other critical messages, such as if the error log is not\nenabled then connection error might go unnoticed. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/error-­‐log.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to audit this setting:\n\nSHOW variables LIKE 'log_error';\nEnsure the Value returned is not empty.\n\"\n  tag \"fix\": \"Perform the following actions to remediate this setting: Open the\nMySQL configuration file (my.cnf or my.ini) Set the log-error option to the\npath for the error log\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-6.1.rb",
        "line": 1
      },
      "id": "M-6.1"
    },
    {
      "title": "9.2 Ensure 'MASTER_SSL_VERIFY_SERVER_CERT' Is Set to 'YES' or '1'\n(Scored)",
      "desc": "In the MySQL slave context the setting MASTER_SSL_VERIFY_SERVER_CERT\nindicates whether the slave should verify the master's certificate.  This\nconfiguration item may be set to Yes or No, and unless SSL has been enabled on\nthe slave, the value will be ignored. When SSL is in use certificate\nverification is important to authenticate the party to which a connection is\nbeing made.  In this case, the slave (client) should verify the master's\n(server's) certificate to authenticate the master prior to continuing the\nconnection.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttps://dev.mysql.com/doc/refman/5.7/en/change-­‐master-­‐to.html ",
        "severity": "medium",
        "cis_id": "9.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "To assess this recommendation, issue the following\nstatement:\nselect ssl_verify_server_cert from mysql.slave_master_info; Verify the value of\nssl_verify_server_cert is 1.\n",
        "fix": "To remediate this setting you must use the CHANGE MASTER TO\ncommand.\nSTOP SLAVE; -- required if replication was already running\nCHANGE MASTER TO MASTER_SSL_VERIFY_SERVER_CERT=1;\nSTART SLAVE; -- required if you want to restart replication\n"
      },
      "code": "control \"M-9.2\" do\n  title \"9.2 Ensure 'MASTER_SSL_VERIFY_SERVER_CERT' Is Set to 'YES' or '1'\n(Scored)\"\n  desc  \"In the MySQL slave context the setting MASTER_SSL_VERIFY_SERVER_CERT\nindicates whether the slave should verify the master's certificate.  This\nconfiguration item may be set to Yes or No, and unless SSL has been enabled on\nthe slave, the value will be ignored. When SSL is in use certificate\nverification is important to authenticate the party to which a connection is\nbeing made.  In this case, the slave (client) should verify the master's\n(server's) certificate to authenticate the master prior to continuing the\nconnection. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttps://dev.mysql.com/doc/refman/5.7/en/change-­‐master-­‐to.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"9.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"To assess this recommendation, issue the following\nstatement:\nselect ssl_verify_server_cert from mysql.slave_master_info; Verify the value of\nssl_verify_server_cert is 1.\n\"\n  tag \"fix\": \"To remediate this setting you must use the CHANGE MASTER TO\ncommand.\nSTOP SLAVE; -- required if replication was already running\nCHANGE MASTER TO MASTER_SSL_VERIFY_SERVER_CERT=1;\nSTART SLAVE; -- required if you want to restart replication\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-9.2.rb",
        "line": 1
      },
      "id": "M-9.2"
    },
    {
      "title": "4.7 Ensure the 'daemon_memcached' Plugin Is Disabled (Scored)",
      "desc": "The InnoDB memcached Plugin allows users to access data stored in\nInnoDB with the memcached protocol. By default the plugin doesn't do\nauthentication, which means that anyone with access to the TCP/IP port of the\nplugin can access and modify the data. However, not all data is exposed by\ndefault.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/innodb-­‐memcached-­‐security.html ",
        "severity": "medium",
        "cis_id": "4.7",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to assess this\nrecommendation:\nSELECT * FROM information_schema.plugins WHERE PLUGIN_NAME='daemon_memcached'\nEnsure that no rows are returned.\n",
        "fix": "To remediate this setting, issue the following command in the\nMySQL command-­‐line client:\nuninstall plugin daemon_memcached;\nThis uninstalls the memcached plugin from the MySQL server.\n",
        "Default Value": "disabled\n"
      },
      "code": "control \"M-4.7\" do\n  title \"4.7 Ensure the 'daemon_memcached' Plugin Is Disabled (Scored)\"\n  desc  \"The InnoDB memcached Plugin allows users to access data stored in\nInnoDB with the memcached protocol. By default the plugin doesn't do\nauthentication, which means that anyone with access to the TCP/IP port of the\nplugin can access and modify the data. However, not all data is exposed by\ndefault. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/innodb-­‐memcached-­‐security.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.7\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to assess this\nrecommendation:\nSELECT * FROM information_schema.plugins WHERE PLUGIN_NAME='daemon_memcached'\nEnsure that no rows are returned.\n\"\n  tag \"fix\": \"To remediate this setting, issue the following command in the\nMySQL command-­‐line client:\nuninstall plugin daemon_memcached;\nThis uninstalls the memcached plugin from the MySQL server.\n\"\n  tag \"Default Value\": \"disabled\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-4.7.rb",
        "line": 1
      },
      "id": "M-4.7"
    },
    {
      "title": "6.5 Ensure audit_log_connection_policy is not set to 'NONE' (Scored)",
      "desc": "The audit_log_connection_policy variable controls how the audit plugin\nwrites connection events to the audit log file. The audit_log_connection_policy\noffers three options: NONE, ERRORS, and ALL. Each option determines whether\nconnection events are logged and the type of connection events that are logged.\nSetting a non 'NONE' value for audit_log_connection_policy ensures at a\nminimum, failed connection events are being logged.  The ERRORS setting will\nlog failed connection events and the ALL setting will log all connection\nevents. For MySQL versions => 5.6.20, the audit_log_policy variable can\noverride the audit_log_connection_policy, potentially invalidating this\nbenchmark recommendation, therefore enforcing a setting for\naudit_log_connection_policy ensures the integrity of this recommendation.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_connection_policy 2.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐logging-­‐control.html\n",
        "severity": "medium",
        "cis_id": "6.5",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "To assess this recommendation, execute the following SQL\nstatement:\nshow variables like '%audit_log_connection_policy%'; Ensure the value is set to\neither ERRORS or ALL.\n",
        "fix": "To remediate this configuration setting, execute one of the\nfollowing SQL statements:\nset global audit_log_connection_policy = ERRORS\nOr\nset global audit_log_connection_policy = ALL To ensure this remediation remains\nindefinite for the life of the MySQL Server, set\naudit_log_connection_policy in the server's assigned MySQL configuration file\n(usually\nnamed my.cnf, but not always).\n\n",
        "Default Value": "The default value for audit_log_connection_policy is\nALL.\n"
      },
      "code": "control \"M-6.5\" do\n  title \"6.5 Ensure audit_log_connection_policy is not set to 'NONE' (Scored)\"\n  desc  \"The audit_log_connection_policy variable controls how the audit plugin\nwrites connection events to the audit log file. The audit_log_connection_policy\noffers three options: NONE, ERRORS, and ALL. Each option determines whether\nconnection events are logged and the type of connection events that are logged.\nSetting a non 'NONE' value for audit_log_connection_policy ensures at a\nminimum, failed connection events are being logged.  The ERRORS setting will\nlog failed connection events and the ALL setting will log all connection\nevents. For MySQL versions => 5.6.20, the audit_log_policy variable can\noverride the audit_log_connection_policy, potentially invalidating this\nbenchmark recommendation, therefore enforcing a setting for\naudit_log_connection_policy ensures the integrity of this recommendation. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_connection_policy 2.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐logging-­‐control.html\n\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.5\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"To assess this recommendation, execute the following SQL\nstatement:\nshow variables like '%audit_log_connection_policy%'; Ensure the value is set to\neither ERRORS or ALL.\n\"\n  tag \"fix\": \"To remediate this configuration setting, execute one of the\nfollowing SQL statements:\nset global audit_log_connection_policy = ERRORS\nOr\nset global audit_log_connection_policy = ALL To ensure this remediation remains\nindefinite for the life of the MySQL Server, set\naudit_log_connection_policy in the server's assigned MySQL configuration file\n(usually\nnamed my.cnf, but not always).\n\n\"\n  tag \"Default Value\": \"The default value for audit_log_connection_policy is\nALL.\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-6.5.rb",
        "line": 1
      },
      "id": "M-6.5"
    },
    {
      "title": "5.2 Ensure 'file_priv' Is Not Set to 'Y' for Non-­‐Administrative\nUsers (Scored)",
      "desc": "The File_priv privilege found in the mysql.user table is used to allow\nor disallow a user from  reading and writing files on the server host.  Any\nuser with the File_priv right granted has the ability to: Read files from the\nlocal file system that are readable by the MySQL server (this includes\nworld-­‐readable files) Write files to the local file system where the MySQL\nserver has write access The File_priv right allows mysql users to read files\nfrom disk and to write files to disk. This may be leveraged by an attacker to\nfurther compromise MySQL.  It should be noted that the MySQL server should not\noverwrite existing files.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/privileges-­‐provided.html#priv_file ",
        "severity": "medium",
        "cis_id": "5.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to audit this setting\n\nselect user, host from mysql.user where File_priv = 'Y';\nEnsure only administrative users are returned in the result set.\n",
        "fix": "Perform the following steps to remediate this setting: Enumerate\nthe non-­‐administrative users found in the result set of the audit\nprocedure For each user, issue the following SQL statement (replace '<user>'\nwith the non-­‐\nadministrative user:\nREVOKE FILE ON *.* FROM '<user>';\n"
      },
      "code": "control \"M-5.2\" do\n  title \"5.2 Ensure 'file_priv' Is Not Set to 'Y' for Non-­‐Administrative\nUsers (Scored)\"\n  desc  \"The File_priv privilege found in the mysql.user table is used to allow\nor disallow a user from  reading and writing files on the server host.  Any\nuser with the File_priv right granted has the ability to: Read files from the\nlocal file system that are readable by the MySQL server (this includes\nworld-­‐readable files) Write files to the local file system where the MySQL\nserver has write access The File_priv right allows mysql users to read files\nfrom disk and to write files to disk. This may be leveraged by an attacker to\nfurther compromise MySQL.  It should be noted that the MySQL server should not\noverwrite existing files. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/privileges-­‐provided.html#priv_file \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"5.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to audit this setting\n\nselect user, host from mysql.user where File_priv = 'Y';\nEnsure only administrative users are returned in the result set.\n\"\n  tag \"fix\": \"Perform the following steps to remediate this setting: Enumerate\nthe non-­‐administrative users found in the result set of the audit\nprocedure For each user, issue the following SQL statement (replace '<user>'\nwith the non-­‐\nadministrative user:\nREVOKE FILE ON *.* FROM '<user>';\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-5.2.rb",
        "line": 1
      },
      "id": "M-5.2"
    },
    {
      "title": "4.3 Ensure 'allow-­‐suspicious-­‐udfs' Is Set to 'FALSE' (Scored)",
      "desc": "This option prevents attaching arbitrary shared library functions as\nuser-­‐defined functions by checking for at least one corresponding method\nnamed _init, _deinit, _reset, _clear, or _add. Preventing shared libraries that\ndo not contain user-­‐defined functions from loading will reduce the attack\nsurface of the server.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/udf-­‐security.html 2.\nhttp://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_allow-­‐suspicious-­‐udfs ",
        "severity": "medium",
        "cis_id": "4.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Perform the following to determine if the recommended\nstate is in place:\nEnsure --allow-suspicious-udfs is not specified in the the mysqld start\nup command line.\nEnsure allow-suspicious-udfs is set to FALSE in the MySQL configuration.\n",
        "fix": "Perform the following to establish the recommended state:\nRemove --allow-suspicious-udfs from the mysqld start up command line.\nRemove allow-suspicious-udfs from the MySQL option file.\n",
        "Default Value": "FALSE\n"
      },
      "code": "control \"M-4.3\" do\n  title \"4.3 Ensure 'allow-­‐suspicious-­‐udfs' Is Set to 'FALSE' (Scored)\"\n  desc  \"This option prevents attaching arbitrary shared library functions as\nuser-­‐defined functions by checking for at least one corresponding method\nnamed _init, _deinit, _reset, _clear, or _add. Preventing shared libraries that\ndo not contain user-­‐defined functions from loading will reduce the attack\nsurface of the server. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/udf-­‐security.html 2.\nhttp://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_allow-­‐suspicious-­‐udfs \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Perform the following to determine if the recommended\nstate is in place:\nEnsure --allow-suspicious-udfs is not specified in the the mysqld start\nup command line.\nEnsure allow-suspicious-udfs is set to FALSE in the MySQL configuration.\n\"\n  tag \"fix\": \"Perform the following to establish the recommended state:\nRemove --allow-suspicious-udfs from the mysqld start up command line.\nRemove allow-suspicious-udfs from the MySQL option file.\n\"\n  tag \"Default Value\": \"FALSE\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-4.3.rb",
        "line": 1
      },
      "id": "M-4.3"
    },
    {
      "title": "7.4 Ensure 'sql_mode' Contains 'NO_AUTO_CREATE_USER' (Scored)",
      "desc": "NO_AUTO_CREATE_USER is an option for sql_mode that prevents a GRANT\nstatement from automatically creating a user when authentication information is\nnot provided. Blank passwords negate the benefits provided by authentication\nmechanisms.  Without this setting an administrative user might accidentally\ncreate a user without a password.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "7.4",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statements to assess this\nrecommendation:\nSELECT @@global.sql_mode;\nSELECT @@session.sql_mode;\nEnsure that each result contains NO_AUTO_CREATE_USER.\n",
        "fix": "Perform the following actions to remediate this setting: Open the\nMySQL configuration file (my.cnf) Find the sql_mode setting in the [mysqld]\narea Add the NO_AUTO_CREATE_USER to the sql_mode setting "
      },
      "code": "control \"M-7.4\" do\n  title \"7.4 Ensure 'sql_mode' Contains 'NO_AUTO_CREATE_USER' (Scored)\"\n  desc  \"NO_AUTO_CREATE_USER is an option for sql_mode that prevents a GRANT\nstatement from automatically creating a user when authentication information is\nnot provided. Blank passwords negate the benefits provided by authentication\nmechanisms.  Without this setting an administrative user might accidentally\ncreate a user without a password. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.4\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statements to assess this\nrecommendation:\nSELECT @@global.sql_mode;\nSELECT @@session.sql_mode;\nEnsure that each result contains NO_AUTO_CREATE_USER.\n\"\n  tag \"fix\": \"Perform the following actions to remediate this setting: Open the\nMySQL configuration file (my.cnf) Find the sql_mode setting in the [mysqld]\narea Add the NO_AUTO_CREATE_USER to the sql_mode setting \"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-7.4.rb",
        "line": 1
      },
      "id": "M-7.4"
    },
    {
      "title": "5.5 Ensure 'shutdown_priv' Is Not Set to 'Y' for Non-­‐Administrative\nUsers (Scored)",
      "desc": "The SHUTDOWN privilege simply enables use of the shutdown option to\nthe mysqladmin command, which allows a user with the SHUTDOWN privilege the\nability to shut down the MySQL server. The SHUTDOWN privilege allows principals\nto shutdown MySQL. This may be leveraged by an attacker to negatively impact\nthe availability of MySQL.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/privileges-­‐\nprovided.html#priv_shutdown ",
        "severity": "medium",
        "cis_id": "5.5",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to audit this setting:\n\nSELECT user, host FROM mysql.user WHERE Shutdown_priv = 'Y';\nEnsure only administrative users are returned in the result set.\n",
        "fix": "Perform the following steps to remediate this setting: Enumerate\nthe non-­‐administrative users found in the result set of the audit\nprocedure For each user, issue the following SQL statement (replace '<user>'\nwith the non-­‐\nadministrative user):\nREVOKE SHUTDOWN ON *.* FROM '<user>';\n"
      },
      "code": "control \"M-5.5\" do\n  title \"5.5 Ensure 'shutdown_priv' Is Not Set to 'Y' for Non-­‐Administrative\nUsers (Scored)\"\n  desc  \"The SHUTDOWN privilege simply enables use of the shutdown option to\nthe mysqladmin command, which allows a user with the SHUTDOWN privilege the\nability to shut down the MySQL server. The SHUTDOWN privilege allows principals\nto shutdown MySQL. This may be leveraged by an attacker to negatively impact\nthe availability of MySQL. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/privileges-­‐\nprovided.html#priv_shutdown \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"5.5\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to audit this setting:\n\nSELECT user, host FROM mysql.user WHERE Shutdown_priv = 'Y';\nEnsure only administrative users are returned in the result set.\n\"\n  tag \"fix\": \"Perform the following steps to remediate this setting: Enumerate\nthe non-­‐administrative users found in the result set of the audit\nprocedure For each user, issue the following SQL statement (replace '<user>'\nwith the non-­‐\nadministrative user):\nREVOKE SHUTDOWN ON *.* FROM '<user>';\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-5.5.rb",
        "line": 1
      },
      "id": "M-5.5"
    },
    {
      "title": "6.2 Ensure Log Files Are Stored on a Non-­‐System Partition (Scored)",
      "desc": "MySQL log files can be set in the MySQL configuration to exist\nanywhere on the filesystem.  It is common practice to ensure that the system\nfilesystem is left uncluttered by application logs.  System filesystems include\nthe root, /var, or /usr. Moving the MySQL logs off the system partition will\nreduce the probability of denial of service via the exhaustion of available\ndisk space to the operating system.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/binary-­‐log.html 2.\nhttp://dev.mysql.com/doc/refman/5.7/en/replication-­‐options-­‐binary-­‐log.html\n",
        "severity": "medium",
        "cis_id": "6.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to assess this\nrecommendation:\nSELECT @@global.log_bin_basename;\nEnsure the value returned does not indicate root ('/'), /var, or /usr.\n",
        "fix": "Perform the following actions to remediate this setting: Open the\nMySQL configuration file (my.cnf) Locate the log-bin entry and set it to a file\nnot on root ('/'), /var, or /usr\n"
      },
      "code": "control \"M-6.2\" do\n  title \"6.2 Ensure Log Files Are Stored on a Non-­‐System Partition (Scored)\"\n  desc  \"MySQL log files can be set in the MySQL configuration to exist\nanywhere on the filesystem.  It is common practice to ensure that the system\nfilesystem is left uncluttered by application logs.  System filesystems include\nthe root, /var, or /usr. Moving the MySQL logs off the system partition will\nreduce the probability of denial of service via the exhaustion of available\ndisk space to the operating system. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/binary-­‐log.html 2.\nhttp://dev.mysql.com/doc/refman/5.7/en/replication-­‐options-­‐binary-­‐log.html\n\"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to assess this\nrecommendation:\nSELECT @@global.log_bin_basename;\nEnsure the value returned does not indicate root ('/'), /var, or /usr.\n\"\n  tag \"fix\": \"Perform the following actions to remediate this setting: Open the\nMySQL configuration file (my.cnf) Locate the log-bin entry and set it to a file\nnot on root ('/'), /var, or /usr\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-6.2.rb",
        "line": 1
      },
      "id": "M-6.2"
    },
    {
      "title": "9.1 Ensure Replication Traffic Is Secured (Not Scored)",
      "desc": "The replication traffic between servers should be secured. Security\nmeasures should include ensuring the confidentiality and integrity of the\ntraffic, and performing mutual authentication between the servers before\nperforming replication. The replication traffic should be secured as it gives\naccess to all transfered information and might leak passwords.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "9.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Check if the replication traffic is using one or more of\nthe following to provide\nconfidentiality and integrity for the traffic, and mutual authentication for\nthe servers:\nA private network\nA VPN\nSSL/TLS\nA SSH Tunnel\n",
        "fix": "Secure the network traffic using one or more technologies to\nprovide confidentiality and\nintegrity for the traffic, and mutual authentication for the servers. "
      },
      "code": "control \"M-9.1\" do\n  title \"9.1 Ensure Replication Traffic Is Secured (Not Scored)\"\n  desc  \"The replication traffic between servers should be secured. Security\nmeasures should include ensuring the confidentiality and integrity of the\ntraffic, and performing mutual authentication between the servers before\nperforming replication. The replication traffic should be secured as it gives\naccess to all transfered information and might leak passwords. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"9.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Check if the replication traffic is using one or more of\nthe following to provide\nconfidentiality and integrity for the traffic, and mutual authentication for\nthe servers:\nA private network\nA VPN\nSSL/TLS\nA SSH Tunnel\n\"\n  tag \"fix\": \"Secure the network traffic using one or more technologies to\nprovide confidentiality and\nintegrity for the traffic, and mutual authentication for the servers. \"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-9.1.rb",
        "line": 1
      },
      "id": "M-9.1"
    },
    {
      "title": "7.3 Ensure Passwords Are Not Stored in the Global Configuration\n(Scored)",
      "desc": "The [client] section of the MySQL configuration file allows setting a\nuser and password to be used. Verify the password option is not used in the\nglobal configuration file (my.cnf). The use of the password parameter may\nnegatively impact the confidentiality of the user's password.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/mysql-­‐config-­‐editor.html ",
        "severity": "medium",
        "cis_id": "7.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "To assess this recommendation, perform the following\nsteps:\nOpen the MySQL configuration file (e.g. my.cnf)\nExamine the [client] section of the MySQL configuration file and ensure\npassword\nis not employed.\n",
        "fix": "Use the mysql_config_editor to store authtentication credentials\nin .mylogin.cnf in\nencrypted form.\nIf not possible, use the user-­‐specific options file, .my.cnf., and\nrestricting file access\npermissions to the user identity.\n"
      },
      "code": "control \"M-7.3\" do\n  title \"7.3 Ensure Passwords Are Not Stored in the Global Configuration\n(Scored)\"\n  desc  \"The [client] section of the MySQL configuration file allows setting a\nuser and password to be used. Verify the password option is not used in the\nglobal configuration file (my.cnf). The use of the password parameter may\nnegatively impact the confidentiality of the user's password. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/mysql-­‐config-­‐editor.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"To assess this recommendation, perform the following\nsteps:\nOpen the MySQL configuration file (e.g. my.cnf)\nExamine the [client] section of the MySQL configuration file and ensure\npassword\nis not employed.\n\"\n  tag \"fix\": \"Use the mysql_config_editor to store authtentication credentials\nin .mylogin.cnf in\nencrypted form.\nIf not possible, use the user-­‐specific options file, .my.cnf., and\nrestricting file access\npermissions to the user identity.\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-7.3.rb",
        "line": 1
      },
      "id": "M-7.3"
    },
    {
      "title": "4.4 Ensure 'local_infile' Is Disabled (Scored)",
      "desc": "The local_infile parameter dictates whether files located on the MySQL\nclient's computer can be loaded or selected via LOAD DATA INFILE or SELECT\nlocal_file. Disabling local_infile reduces an attacker's ability to read\nsensitive files off the affected server via a SQL injection vulnerability.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/string-­‐functions.html#function_load-­‐file\n2. http://dev.mysql.com/doc/refman/5.7/en/load-­‐data.html ",
        "severity": "medium",
        "cis_id": "4.4",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement and ensure the Value\nfield is set to OFF:\nSHOW VARIABLES WHERE Variable_name = 'local_infile';\n",
        "fix": "Add the following line to the [mysqld] section of the MySQL\nconfiguration file and restart\nthe MySQL service:\nlocal-infile=0 ",
        "Default Value": "ON\n"
      },
      "code": "control \"M-4.4\" do\n  title \"4.4 Ensure 'local_infile' Is Disabled (Scored)\"\n  desc  \"The local_infile parameter dictates whether files located on the MySQL\nclient's computer can be loaded or selected via LOAD DATA INFILE or SELECT\nlocal_file. Disabling local_infile reduces an attacker's ability to read\nsensitive files off the affected server via a SQL injection vulnerability. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/string-­‐functions.html#function_load-­‐file\n2. http://dev.mysql.com/doc/refman/5.7/en/load-­‐data.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.4\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement and ensure the Value\nfield is set to OFF:\nSHOW VARIABLES WHERE Variable_name = 'local_infile';\n\"\n  tag \"fix\": \"Add the following line to the [mysqld] section of the MySQL\nconfiguration file and restart\nthe MySQL service:\nlocal-infile=0 \"\n  tag \"Default Value\": \"ON\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-4.4.rb",
        "line": 1
      },
      "id": "M-4.4"
    },
    {
      "title": "9.5 Ensure No Replication Users Have Wildcard Hostnames (Scored)",
      "desc": "MySQL can make use of host wildcards when granting permissions to\nusers on specific databases.  For example, you may grant a given privilege to\n'<user>'@'%'. Avoiding the use of wildcards within hostnames helps control the\nspecific locations from which a given user may connect to and interact with the\ndatabase.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "9.5",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to assess this\nrecommendation:\nSELECT user, host FROM mysql.user WHERE user='repl' AND host = '%';\nEnsure no rows are returned.\n",
        "fix": "Perform the following actions to remediate this setting:\nEnumerate all users returned after running the audit procedure Either ALTER the\nuser's host to be specific or DROP the user\n"
      },
      "code": "control \"M-9.5\" do\n  title \"9.5 Ensure No Replication Users Have Wildcard Hostnames (Scored)\"\n  desc  \"MySQL can make use of host wildcards when granting permissions to\nusers on specific databases.  For example, you may grant a given privilege to\n'<user>'@'%'. Avoiding the use of wildcards within hostnames helps control the\nspecific locations from which a given user may connect to and interact with the\ndatabase. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"9.5\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to assess this\nrecommendation:\nSELECT user, host FROM mysql.user WHERE user='repl' AND host = '%';\nEnsure no rows are returned.\n\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\nEnumerate all users returned after running the audit procedure Either ALTER the\nuser's host to be specific or DROP the user\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-9.5.rb",
        "line": 1
      },
      "id": "M-9.5"
    },
    {
      "title": "6.6 Ensure audit_log_exclude_accounts is set to NULL (Scored)",
      "desc": "The audit_log_exclude_accounts variable enables the administrator to\nset accounts for which events will not be logged in the audit log. The\naudit_log_exclude_accounts variable has two permitted values, either NULL or a\nlist of MySQL accounts. Setting this variable correctly ensures no single user\nis able to unintentionally evade being logged. Particular attention should be\nmade to privileged accounts, as such accounts will generally be bestowed with\nmore privileges than normal users, and should not be listed against this\nvariable.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_exclude_accounts ",
        "severity": "medium",
        "cis_id": "6.6",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "To assess this recommendation, execute the following SQL\nstatement:\nSHOW VARIABLES LIKE '%audit_log_exclude_accounts%';\nEnsure the resulting audit_log_exclude_accounts value is NULL.\n",
        "fix": "To remediate this configuration setting, execute the following\nSQL statement\nSET GLOBAL audit_log_exclude_accounts = NULL Or set\naudit_log_exclude_accounts=NULL in my.cnf.\n",
        "Default Value": "audit_log_exclude_accounts is set to NULL by\ndefault.\n\n"
      },
      "code": "control \"M-6.6\" do\n  title \"6.6 Ensure audit_log_exclude_accounts is set to NULL (Scored)\"\n  desc  \"The audit_log_exclude_accounts variable enables the administrator to\nset accounts for which events will not be logged in the audit log. The\naudit_log_exclude_accounts variable has two permitted values, either NULL or a\nlist of MySQL accounts. Setting this variable correctly ensures no single user\nis able to unintentionally evade being logged. Particular attention should be\nmade to privileged accounts, as such accounts will generally be bestowed with\nmore privileges than normal users, and should not be listed against this\nvariable. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_exclude_accounts \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.6\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"To assess this recommendation, execute the following SQL\nstatement:\nSHOW VARIABLES LIKE '%audit_log_exclude_accounts%';\nEnsure the resulting audit_log_exclude_accounts value is NULL.\n\"\n  tag \"fix\": \"To remediate this configuration setting, execute the following\nSQL statement\nSET GLOBAL audit_log_exclude_accounts = NULL Or set\naudit_log_exclude_accounts=NULL in my.cnf.\n\"\n  tag \"Default Value\": \"audit_log_exclude_accounts is set to NULL by\ndefault.\\n\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-6.6.rb",
        "line": 1
      },
      "id": "M-6.6"
    },
    {
      "title": "5.1 Ensure Only Administrative Users Have Full Database Access\n(Scored)",
      "desc": "The mysql.user and mysql.db tables list a variety of privileges that\ncan be granted (or denied) to MySQL users.   Some of the privileges of concern\ninclude:  Select_priv, Insert_priv, Update_priv, Delete_priv, Drop_priv, and so\non.  Typically, these privileges should not be available to every MySQL user\nand often are reserved for administrative use only. Limiting the accessibility\nof the 'mysql' database will protect the confidentiality, integrity, and\navailability of the data housed within MySQL.  A user which has direct access\nto mysql.* might view password hashes, change permissions, or alter or destroy\ninformation intentionally or unintentionally.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "5.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement(s) to assess this\nrecommendation:\nSELECT user, host\nFROM mysql.user\nWHERE (Select_priv = 'Y')\nOR (Insert_priv = 'Y')\nOR (Update_priv = 'Y')\nOR (Delete_priv = 'Y')\nOR (Create_priv = 'Y')\nOR (Drop_priv = 'Y');\nSELECT user, host\nFROM mysql.db\nWHERE db = 'mysql'\nAND ((Select_priv = 'Y')\nOR (Insert_priv = 'Y')\nOR (Update_priv = 'Y')\nOR (Delete_priv = 'Y')\nOR (Create_priv = 'Y')\nOR (Drop_priv = 'Y')); Ensure all users returned are administrative users.\n",
        "fix": "Perform the following actions to remediate this setting:\nEnumerate non-­‐administrative users resulting from the audit procedure For\neach non-­‐administrative user, use the REVOKE statement to remove privileges\nas\nappropriate\n"
      },
      "code": "control \"M-5.1\" do\n  title \"5.1 Ensure Only Administrative Users Have Full Database Access\n(Scored)\"\n  desc  \"The mysql.user and mysql.db tables list a variety of privileges that\ncan be granted (or denied) to MySQL users.   Some of the privileges of concern\ninclude:  Select_priv, Insert_priv, Update_priv, Delete_priv, Drop_priv, and so\non.  Typically, these privileges should not be available to every MySQL user\nand often are reserved for administrative use only. Limiting the accessibility\nof the 'mysql' database will protect the confidentiality, integrity, and\navailability of the data housed within MySQL.  A user which has direct access\nto mysql.* might view password hashes, change permissions, or alter or destroy\ninformation intentionally or unintentionally. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"5.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement(s) to assess this\nrecommendation:\nSELECT user, host\nFROM mysql.user\nWHERE (Select_priv = 'Y')\nOR (Insert_priv = 'Y')\nOR (Update_priv = 'Y')\nOR (Delete_priv = 'Y')\nOR (Create_priv = 'Y')\nOR (Drop_priv = 'Y');\nSELECT user, host\nFROM mysql.db\nWHERE db = 'mysql'\nAND ((Select_priv = 'Y')\nOR (Insert_priv = 'Y')\nOR (Update_priv = 'Y')\nOR (Delete_priv = 'Y')\nOR (Create_priv = 'Y')\nOR (Drop_priv = 'Y')); Ensure all users returned are administrative users.\n\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\nEnumerate non-­‐administrative users resulting from the audit procedure For\neach non-­‐administrative user, use the REVOKE statement to remove privileges\nas\nappropriate\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-5.1.rb",
        "line": 1
      },
      "id": "M-5.1"
    },
    {
      "title": "7.7 Ensure No Users Have Wildcard Hostnames (Scored)",
      "desc": "MySQL can make use of host wildcards when granting permissions to\nusers on specific databases.  For example, you may grant a given privilege to\n'<user>'@'%'. Avoiding the use of wildcards within hostnames helps control the\nspecific locations from which a given user may connect to and interact with the\ndatabase.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "7.7",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to assess this\nrecommendation:\nSELECT user, host FROM mysql.user WHERE host = '%';\nEnsure no rows are returned.\n",
        "fix": "Perform the following actions to remediate this setting:\nEnumerate all users returned after running the audit procedure Either ALTER the\nuser's host to be specific or DROP the user "
      },
      "code": "control \"M-7.7\" do\n  title \"7.7 Ensure No Users Have Wildcard Hostnames (Scored)\"\n  desc  \"MySQL can make use of host wildcards when granting permissions to\nusers on specific databases.  For example, you may grant a given privilege to\n'<user>'@'%'. Avoiding the use of wildcards within hostnames helps control the\nspecific locations from which a given user may connect to and interact with the\ndatabase. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.7\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to assess this\nrecommendation:\nSELECT user, host FROM mysql.user WHERE host = '%';\nEnsure no rows are returned.\n\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\nEnumerate all users returned after running the audit procedure Either ALTER the\nuser's host to be specific or DROP the user \"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-7.7.rb",
        "line": 1
      },
      "id": "M-7.7"
    },
    {
      "title": "6.7 Ensure audit_log_include_accounts is set to NULL (Scored)",
      "desc": "The audit_log_include_accounts variable enables the administrator to\nset accounts for which events should be logged in the audit log. The\naudit_log_include_accounts variable has two permitted values, either NULL or a\nlist of MySQL accounts. Setting this variable correctly ensures all MySQL users\nare being logged in the audit log.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_include_accounts ",
        "severity": "medium",
        "cis_id": "6.7",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "To assess this recommendation, execute the following SQL\nstatement:\nSHOW VARIABLES LIKE '%audit_log_include_accounts%';\nEnsure the resulting value is NULL.\n",
        "fix": "To remediate this configuration setting, execute the following\nSQL statement\nSET GLOBAL audit_log_include_accounts = NULL Or set\naudit_log_include_accounts=NULL in my.cnf.\n",
        "Default Value": "audit_log_exclude_accounts is set to NULL by\ndefault.\n\n"
      },
      "code": "control \"M-6.7\" do\n  title \"6.7 Ensure audit_log_include_accounts is set to NULL (Scored)\"\n  desc  \"The audit_log_include_accounts variable enables the administrator to\nset accounts for which events should be logged in the audit log. The\naudit_log_include_accounts variable has two permitted values, either NULL or a\nlist of MySQL accounts. Setting this variable correctly ensures all MySQL users\nare being logged in the audit log. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_include_accounts \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.7\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"To assess this recommendation, execute the following SQL\nstatement:\nSHOW VARIABLES LIKE '%audit_log_include_accounts%';\nEnsure the resulting value is NULL.\n\"\n  tag \"fix\": \"To remediate this configuration setting, execute the following\nSQL statement\nSET GLOBAL audit_log_include_accounts = NULL Or set\naudit_log_include_accounts=NULL in my.cnf.\n\"\n  tag \"Default Value\": \"audit_log_exclude_accounts is set to NULL by\ndefault.\\n\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-6.7.rb",
        "line": 1
      },
      "id": "M-6.7"
    },
    {
      "title": "9.4 Ensure 'super_priv' Is Not Set to 'Y' for Replication Users\n(Scored)",
      "desc": "The SUPER privilege found in the mysql.user table governs the use of a\nvariety of MySQL features.  These features include, CHANGE MASTER TO, KILL,\nmysqladmin kill option, PURGE BINARY LOGS, SET GLOBAL, mysqladmin debug option,\nlogging control, and more. The SUPER privilege allows principals to perform\nmany actions, including view and terminate currently executing MySQL statements\n(including statements used to manage passwords). This privilege also provides\nthe ability to configure MySQL, such as enable/disable logging, alter data,\ndisable/enable features.  Limiting the accounts that have the SUPER privilege\nreduces the chances that an attacker can exploit these capabilities.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/privileges-­‐provided.html#priv_super ",
        "severity": "medium",
        "cis_id": "9.4",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to audit this setting:\n\nselect user, host from mysql.user where user='repl' and Super_priv = 'Y';\nNo rows should be returned.\nNOTE: Substitute your replication user's name for repl in the above query.\n",
        "fix": "Execute the following steps to remediate this setting: Enumerate\nthe replication users found in the result set of the audit procedure For each\nreplication user, issue the following SQL statement (replace 'repl' with\nyour replication user's name):\nREVOKE SUPER ON *.* FROM 'repl';\n"
      },
      "code": "control \"M-9.4\" do\n  title \"9.4 Ensure 'super_priv' Is Not Set to 'Y' for Replication Users\n(Scored)\"\n  desc  \"The SUPER privilege found in the mysql.user table governs the use of a\nvariety of MySQL features.  These features include, CHANGE MASTER TO, KILL,\nmysqladmin kill option, PURGE BINARY LOGS, SET GLOBAL, mysqladmin debug option,\nlogging control, and more. The SUPER privilege allows principals to perform\nmany actions, including view and terminate currently executing MySQL statements\n(including statements used to manage passwords). This privilege also provides\nthe ability to configure MySQL, such as enable/disable logging, alter data,\ndisable/enable features.  Limiting the accounts that have the SUPER privilege\nreduces the chances that an attacker can exploit these capabilities. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/privileges-­‐provided.html#priv_super \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"9.4\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to audit this setting:\n\nselect user, host from mysql.user where user='repl' and Super_priv = 'Y';\nNo rows should be returned.\nNOTE: Substitute your replication user's name for repl in the above query.\n\"\n  tag \"fix\": \"Execute the following steps to remediate this setting: Enumerate\nthe replication users found in the result set of the audit procedure For each\nreplication user, issue the following SQL statement (replace 'repl' with\nyour replication user's name):\nREVOKE SUPER ON *.* FROM 'repl';\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-9.4.rb",
        "line": 1
      },
      "id": "M-9.4"
    },
    {
      "title": "4.1 Ensure Latest Security Patches Are Applied (Not Scored)",
      "desc": "Periodically, updates to MySQL server are released to resolve bugs,\nmitigate vulnerabilities, and provide new features. It is recommended that\nMySQL installations are up to date with the latest security updates.\nMaintaining currency with MySQL patches will help reduce risk associated with\nknown vulnerabilities present in the MySQL server. Without the latest security\npatches MySQL might have known vulnerabilities which might be used by an\nattacker to gain access.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://www.oracle.com/technetwork/topics/security/alerts-­‐086861.html 2.\nhttp://dev.mysql.com/doc/relnotes/mysql/5.7/en/ 3.\nhttp://web.nvd.nist.gov/view/vuln/search-­‐\nresults?adv_search=true&cves=on&cpe_vendor=cpe%3a%2f%3aoracle&cpe_produ\nct=cpe%3a%2f%3aoracle%3amysql&cpe_version=cpe%3a%2f%3aoracle%3amysq l%3a5.7.0 ",
        "severity": "medium",
        "cis_id": "4.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to identify the MySQL\nserver version:\nSHOW VARIABLES WHERE Variable_name LIKE 'version'; Now compare the version with\nthe security announcements from Oracle and/or the OS if\nthe OS packages are used.\n",
        "fix": "Install the latest patches for your version or upgrade to the\nlatest version.\n"
      },
      "code": "control \"M-4.1\" do\n  title \"4.1 Ensure Latest Security Patches Are Applied (Not Scored)\"\n  desc  \"Periodically, updates to MySQL server are released to resolve bugs,\nmitigate vulnerabilities, and provide new features. It is recommended that\nMySQL installations are up to date with the latest security updates.\nMaintaining currency with MySQL patches will help reduce risk associated with\nknown vulnerabilities present in the MySQL server. Without the latest security\npatches MySQL might have known vulnerabilities which might be used by an\nattacker to gain access. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://www.oracle.com/technetwork/topics/security/alerts-­‐086861.html 2.\nhttp://dev.mysql.com/doc/relnotes/mysql/5.7/en/ 3.\nhttp://web.nvd.nist.gov/view/vuln/search-­‐\nresults?adv_search=true&cves=on&cpe_vendor=cpe%3a%2f%3aoracle&cpe_produ\nct=cpe%3a%2f%3aoracle%3amysql&cpe_version=cpe%3a%2f%3aoracle%3amysq l%3a5.7.0 \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to identify the MySQL\nserver version:\nSHOW VARIABLES WHERE Variable_name LIKE 'version'; Now compare the version with\nthe security announcements from Oracle and/or the OS if\nthe OS packages are used.\n\"\n  tag \"fix\": \"Install the latest patches for your version or upgrade to the\nlatest version.\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-4.1.rb",
        "line": 1
      },
      "id": "M-4.1"
    },
    {
      "title": "7.6 Ensure Password Policy Is in Place (Scored)",
      "desc": "Password complexity includes password characteristics such as length,\ncase, length, and character sets. Complex passwords help mitigate dictionary,\nbrute forcing, and other password attacks.  This recommendation prevents users\nfrom choosing weak passwords which can easily be guessed.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/validate-­‐password-­‐plugin.html ",
        "severity": "medium",
        "cis_id": "7.6",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statements to assess this\nrecommendation:\nSHOW VARIABLES LIKE 'validate_password%';\nThe result set from the above statement should show: validate_password_length\nshould be 14 or more\nvalidate_password_mixed_case_count should be 1 or more\nvalidate_password_number_count should be 1 or more\nvalidate_password_special_char_count should be 1 or more\nvalidate_password_policy should be MEDIUM or STRONG\nThe following lines should be present in the global configuration:\nplugin-load=validate_password.so\nvalidate-password=FORCE_PLUS_PERMANENT Check if users have a password which is\nidentical to the username:\nSELECT User,Password,Host FROM mysql.user\nWHERE password=CONCAT('*', UPPER(SHA1(UNHEX(SHA1(user)))));\nNOTE: This method is only capable of checking the post-­‐4.1 password format\nwhich is also\nknown as mysql_native_password.\n\n",
        "fix": "Add to the global configuration:\nplugin-load=validate_password.so\nvalidate-password=FORCE_PLUS_PERMANENT\nvalidate_password_length=14\nvalidate_password_mixed_case_count=1\nvalidate_password_number_count=1\nvalidate_password_special_char_count=1\nvalidate_password_policy=MEDIUM\nAnd change passwords for users which have passwords which are identical to\ntheir\nusername.\n"
      },
      "code": "control \"M-7.6\" do\n  title \"7.6 Ensure Password Policy Is in Place (Scored)\"\n  desc  \"Password complexity includes password characteristics such as length,\ncase, length, and character sets. Complex passwords help mitigate dictionary,\nbrute forcing, and other password attacks.  This recommendation prevents users\nfrom choosing weak passwords which can easily be guessed. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/validate-­‐password-­‐plugin.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.6\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statements to assess this\nrecommendation:\nSHOW VARIABLES LIKE 'validate_password%';\nThe result set from the above statement should show: validate_password_length\nshould be 14 or more\nvalidate_password_mixed_case_count should be 1 or more\nvalidate_password_number_count should be 1 or more\nvalidate_password_special_char_count should be 1 or more\nvalidate_password_policy should be MEDIUM or STRONG\nThe following lines should be present in the global configuration:\nplugin-load=validate_password.so\nvalidate-password=FORCE_PLUS_PERMANENT Check if users have a password which is\nidentical to the username:\nSELECT User,Password,Host FROM mysql.user\nWHERE password=CONCAT('*', UPPER(SHA1(UNHEX(SHA1(user)))));\nNOTE: This method is only capable of checking the post-­‐4.1 password format\nwhich is also\nknown as mysql_native_password.\n\n\"\n  tag \"fix\": \"Add to the global configuration:\nplugin-load=validate_password.so\nvalidate-password=FORCE_PLUS_PERMANENT\nvalidate_password_length=14\nvalidate_password_mixed_case_count=1\nvalidate_password_number_count=1\nvalidate_password_special_char_count=1\nvalidate_password_policy=MEDIUM\nAnd change passwords for users which have passwords which are identical to\ntheir\nusername.\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-7.6.rb",
        "line": 1
      },
      "id": "M-7.6"
    },
    {
      "title": "5.4 Ensure 'super_priv' Is Not Set to 'Y' for Non-­‐Administrative\nUsers (Scored)",
      "desc": "The SUPER privilege found in the mysql.user table governs the use of a\nvariety of MySQL features.  These features include, CHANGE MASTER TO, KILL,\nmysqladmin kill option, PURGE BINARY LOGS, SET GLOBAL, mysqladmin debug option,\nlogging control, and more. The SUPER privilege allows principals to perform\nmany actions, including view and terminate currently executing MySQL statements\n(including statements used to manage passwords). This privilege also provides\nthe ability to configure MySQL, such as enable/disable logging, alter data,\ndisable/enable features.  Limiting the accounts that have the SUPER privilege\nreduces the chances that an attacker can exploit these capabilities.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/privileges-­‐provided.html#priv_super ",
        "severity": "medium",
        "cis_id": "5.4",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement to audit this setting:\n\nselect user, host from mysql.user where Super_priv = 'Y';\nEnsure only administrative users are returned in the result set.\n",
        "fix": "Perform the following steps to remediate this setting: Enumerate\nthe non-­‐administrative users found in the result set of the audit\nprocedure For each user, issue the following SQL statement (replace '<user>'\nwith the non-­‐\nadministrative user:\nREVOKE SUPER ON *.* FROM '<user>';\n"
      },
      "code": "control \"M-5.4\" do\n  title \"5.4 Ensure 'super_priv' Is Not Set to 'Y' for Non-­‐Administrative\nUsers (Scored)\"\n  desc  \"The SUPER privilege found in the mysql.user table governs the use of a\nvariety of MySQL features.  These features include, CHANGE MASTER TO, KILL,\nmysqladmin kill option, PURGE BINARY LOGS, SET GLOBAL, mysqladmin debug option,\nlogging control, and more. The SUPER privilege allows principals to perform\nmany actions, including view and terminate currently executing MySQL statements\n(including statements used to manage passwords). This privilege also provides\nthe ability to configure MySQL, such as enable/disable logging, alter data,\ndisable/enable features.  Limiting the accounts that have the SUPER privilege\nreduces the chances that an attacker can exploit these capabilities. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/privileges-­‐provided.html#priv_super \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"5.4\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement to audit this setting:\n\nselect user, host from mysql.user where Super_priv = 'Y';\nEnsure only administrative users are returned in the result set.\n\"\n  tag \"fix\": \"Perform the following steps to remediate this setting: Enumerate\nthe non-­‐administrative users found in the result set of the audit\nprocedure For each user, issue the following SQL statement (replace '<user>'\nwith the non-­‐\nadministrative user:\nREVOKE SUPER ON *.* FROM '<user>';\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-5.4.rb",
        "line": 1
      },
      "id": "M-5.4"
    },
    {
      "title": "6.3 Ensure 'log_warnings' Is Set to '2' (Scored)",
      "desc": "The log_warnings system variable, enabled by default, provides\nadditional information to the MySQL log.  A value of 1 enables logging of\nwarning messages, and higher integer values tend to enable more logging. NOTE:\nlog_warnings has been deprecated as of MySQL 5.7.2. Setting log_warnings will\nalso cause log_error_verbosity to be set.The variable scope for log_warnings is\nglobal. This might help to detect malicious behavior by logging communication\nerrors and aborted connections.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_log-­‐warnings ",
        "severity": "medium",
        "cis_id": "6.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Execute the following SQL statement to assess this\nrecommendation:\nSHOW GLOBAL VARIABLES LIKE 'log_warnings';\nEnsure the Value returned equals 2.\n",
        "fix": "Perform the following actions to remediate this setting:\nOpen the MySQL configuration file (my.cnf)\nEnsure the following line is found in the mysqld section\nlog-warnings = 2\n",
        "Default Value": "The option is enabled (1) by default.\n"
      },
      "code": "control \"M-6.3\" do\n  title \"6.3 Ensure 'log_warnings' Is Set to '2' (Scored)\"\n  desc  \"The log_warnings system variable, enabled by default, provides\nadditional information to the MySQL log.  A value of 1 enables logging of\nwarning messages, and higher integer values tend to enable more logging. NOTE:\nlog_warnings has been deprecated as of MySQL 5.7.2. Setting log_warnings will\nalso cause log_error_verbosity to be set.The variable scope for log_warnings is\nglobal. This might help to detect malicious behavior by logging communication\nerrors and aborted connections. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_log-­‐warnings \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Execute the following SQL statement to assess this\nrecommendation:\nSHOW GLOBAL VARIABLES LIKE 'log_warnings';\nEnsure the Value returned equals 2.\n\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\nOpen the MySQL configuration file (my.cnf)\nEnsure the following line is found in the mysqld section\nlog-warnings = 2\n\"\n  tag \"Default Value\": \"The option is enabled (1) by default.\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-6.3.rb",
        "line": 1
      },
      "id": "M-6.3"
    },
    {
      "title": "7.2 Ensure 'secure_auth' is set to 'ON' (Scored)",
      "desc": "This option dictates whether the server will deny connections by\nclients that attempt to use accounts that have their password stored in the\nmysql_old_password format. Enabling this option will prevent all use of\npasswords employing the old format (and hence insecure communication over the\nnetwork).",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_secure-­‐auth ",
        "severity": "medium",
        "cis_id": "7.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statement and ensure the Value\nfield is not set to ON:\nSHOW VARIABLES WHERE Variable_name = 'secure_auth';\n",
        "fix": "Add the following line to [mysqld] portions of the MySQL option\nfile to establish the\nrecommended state:\nsecure_auth=ON ",
        "Default Value": "Before MySQL 5.6.5, this option is disabled by default.\nAs of MySQL 5.6.5, it is enabled by\ndefault; to disable it, use\n--skip-secure-auth.\n"
      },
      "code": "control \"M-7.2\" do\n  title \"7.2 Ensure 'secure_auth' is set to 'ON' (Scored)\"\n  desc  \"This option dictates whether the server will deny connections by\nclients that attempt to use accounts that have their password stored in the\nmysql_old_password format. Enabling this option will prevent all use of\npasswords employing the old format (and hence insecure communication over the\nnetwork). \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_secure-­‐auth \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statement and ensure the Value\nfield is not set to ON:\nSHOW VARIABLES WHERE Variable_name = 'secure_auth';\n\"\n  tag \"fix\": \"Add the following line to [mysqld] portions of the MySQL option\nfile to establish the\nrecommended state:\nsecure_auth=ON \"\n  tag \"Default Value\": \"Before MySQL 5.6.5, this option is disabled by default.\nAs of MySQL 5.6.5, it is enabled by\\ndefault; to disable it, use\n--skip-secure-auth.\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-7.2.rb",
        "line": 1
      },
      "id": "M-7.2"
    },
    {
      "title": "8.1 Ensure 'have_ssl' Is Set to 'YES' (Scored)",
      "desc": "All network traffic must use SSL/TLS when traveling over untrusted\nnetworks. The SSL/TLS-­‐protected MySQL protocol helps to prevent eavesdropping\nand man-­‐in-­‐the-­‐ middle attacks.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/ssl-­‐connections.html\n2. http://dev.mysql.com/doc/refman/5.7/en/ssl-­‐options.html ",
        "severity": "medium",
        "cis_id": "8.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL statements to assess this\nrecommendation:\nSHOW variables WHERE variable_name = 'have_ssl';\nEnsure the Value returned is YES.\nNOTE: have_openssl is an alias for have_ssl as of MySQL 5.0.38.  MySQL can be\nbuild\nwith OpenSSL or YaSSL.\n",
        "fix": "Follow the procedures as documented in the MySQL 5.6 Reference\nManual to setup SSL.\n",
        "Default Value": "DISABLED\n"
      },
      "code": "control \"M-8.1\" do\n  title \"8.1 Ensure 'have_ssl' Is Set to 'YES' (Scored)\"\n  desc  \"All network traffic must use SSL/TLS when traveling over untrusted\nnetworks. The SSL/TLS-­‐protected MySQL protocol helps to prevent eavesdropping\nand man-­‐in-­‐the-­‐ middle attacks. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/ssl-­‐connections.html\n2. http://dev.mysql.com/doc/refman/5.7/en/ssl-­‐options.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"8.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL statements to assess this\nrecommendation:\nSHOW variables WHERE variable_name = 'have_ssl';\nEnsure the Value returned is YES.\nNOTE: have_openssl is an alias for have_ssl as of MySQL 5.0.38.  MySQL can be\nbuild\nwith OpenSSL or YaSSL.\n\"\n  tag \"fix\": \"Follow the procedures as documented in the MySQL 5.6 Reference\nManual to setup SSL.\n\"\n  tag \"Default Value\": \"DISABLED\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-8.1.rb",
        "line": 1
      },
      "id": "M-8.1"
    },
    {
      "title": "4.5 Ensure 'mysqld' Is Not Started with '-­‐-­‐skip-­‐grant-­‐tables'\n(Scored)",
      "desc": "This option causes mysqld to start without using the privilege system.\nIf this option is used, all clients of the affected server will have\nunrestricted access to all databases.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_skip-­‐grant-­‐tables ",
        "severity": "medium",
        "cis_id": "4.5",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following to determine if the recommended\nstate is in place:\nOpen the MySQL configuration (e.g. my.cnf) file and search for\nskip-­‐grant-­‐tables\nEnsure skip-grant-tables is set to FALSE\n",
        "fix": "Perform the following to establish the recommended state: Open\nthe MySQL configuration (e.g. my.cnf) file and set:\nskip-grant-tables = FALSE\n"
      },
      "code": "control \"M-4.5\" do\n  title \"4.5 Ensure 'mysqld' Is Not Started with '-­‐-­‐skip-­‐grant-­‐tables'\n(Scored)\"\n  desc  \"This option causes mysqld to start without using the privilege system.\nIf this option is used, all clients of the affected server will have\nunrestricted access to all databases. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_skip-­‐grant-­‐tables \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"4.5\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following to determine if the recommended\nstate is in place:\nOpen the MySQL configuration (e.g. my.cnf) file and search for\nskip-­‐grant-­‐tables\nEnsure skip-grant-tables is set to FALSE\n\"\n  tag \"fix\": \"Perform the following to establish the recommended state: Open\nthe MySQL configuration (e.g. my.cnf) file and set:\nskip-grant-tables = FALSE\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-4.5.rb",
        "line": 1
      },
      "id": "M-4.5"
    },
    {
      "title": "6.8 Ensure audit_log_policy is set to log logins (Scored)",
      "desc": "With the audit_log_policy setting the amount of information which is\nsent to the audit log is controlled.  It must be set to log logins. If this\nsetting is set to QUERIES or NONE then connections are not written to the audit\nlog file.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_policy ",
        "severity": "medium",
        "cis_id": "6.8",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "SHOW GLOBAL VARIABLES LIKE 'audit_log_policy'; The result\nmust be LOGINS or ALL.\n",
        "fix": "Set audit_log_policy='ALL' or audit_log_policy='LOGINS' in the\nMySQL configuration\nfile and activate the setting by restarting the server or executing SET GLOBAL\n\naudit_log_policy='ALL'; or SET GLOBAL audit_log_policy='LOGINS';\n",
        "Default Value": "ALL\n"
      },
      "code": "control \"M-6.8\" do\n  title \"6.8 Ensure audit_log_policy is set to log logins (Scored)\"\n  desc  \"With the audit_log_policy setting the amount of information which is\nsent to the audit log is controlled.  It must be set to log logins. If this\nsetting is set to QUERIES or NONE then connections are not written to the audit\nlog file. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_policy \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.8\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"SHOW GLOBAL VARIABLES LIKE 'audit_log_policy'; The result\nmust be LOGINS or ALL.\n\"\n  tag \"fix\": \"Set audit_log_policy='ALL' or audit_log_policy='LOGINS' in the\nMySQL configuration\nfile and activate the setting by restarting the server or executing SET GLOBAL\n\naudit_log_policy='ALL'; or SET GLOBAL audit_log_policy='LOGINS';\n\"\n  tag \"Default Value\": \"ALL\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-6.8.rb",
        "line": 1
      },
      "id": "M-6.8"
    },
    {
      "title": "3.1 Ensure 'datadir' Has Appropriate Permissions and Ownership\n(Scored)",
      "desc": "The data directory is the location of the MySQL databases. Limiting\nthe accessibility of these objects will protect the confidentiality, integrity,\nand availability of the MySQL database.  If someone other than the MySQL user\nis allowed to read files from the data directory he or she might be able to\nread data from the mysql.user table which contains passwords.  Additionally,\nthe ability to create files can lead to denial of service, or might otherwise\nallow someone to gain access to specific data by manually creating a file with\na view definition.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following steps to assess this recommendation:\nExecute the following SQL statement to determine the Value of datadir\nshow variables where variable_name = 'datadir'; Execute the following command\nat a terminal prompt\nls -l <datadir>/.. | egrep\n'^d[r|w|x]{3}------\\s*.\\s*mysql\\s*mysql\\s*\\d*.*mysql'\nLack of output implies a finding.\n",
        "fix": "Execute the following commands at a terminal prompt:\nchmod 700 <datadir>\nchown mysql:mysql <datadir> "
      },
      "code": "control \"M-3.1\" do\n  title \"3.1 Ensure 'datadir' Has Appropriate Permissions and Ownership\n(Scored)\"\n  desc  \"The data directory is the location of the MySQL databases. Limiting\nthe accessibility of these objects will protect the confidentiality, integrity,\nand availability of the MySQL database.  If someone other than the MySQL user\nis allowed to read files from the data directory he or she might be able to\nread data from the mysql.user table which contains passwords.  Additionally,\nthe ability to create files can lead to denial of service, or might otherwise\nallow someone to gain access to specific data by manually creating a file with\na view definition. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"3.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following steps to assess this recommendation:\nExecute the following SQL statement to determine the Value of datadir\nshow variables where variable_name = 'datadir'; Execute the following command\nat a terminal prompt\nls -l <datadir>/.. | egrep\n'^d[r|w|x]{3}------\\\\s*.\\\\s*mysql\\\\s*mysql\\\\s*\\\\d*.*mysql'\nLack of output implies a finding.\n\"\n  tag \"fix\": \"Execute the following commands at a terminal prompt:\nchmod 700 <datadir>\nchown mysql:mysql <datadir> \"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-3.1.rb",
        "line": 1
      },
      "id": "M-3.1"
    },
    {
      "title": "6.11 Set audit_log_strategy to SYNCHRONOUS or SEMISYNCRONOUS (Scored)",
      "desc": "The audit_log_strategy must be set to SYNCHRONOUS or SEMISYNCHRONOUS\nThis setting controls how information is written to the audit log. It can be\nset to SYNCHRONOUS to make it fully durable or other settings which are less\ndurable but have less performance overhead.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_strategy ",
        "severity": "medium",
        "cis_id": "6.11",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "To assess this recommendation, execute the following SQL\nstatement:\nSHOW GLOBAL VARIABLES LIKE 'audit_log_strategy';\nThe result should be SYNCHRONOUS or SEMISYNCHRONOUS\n",
        "fix": "To remediate this configuration: Open the MySQL configuration\nfile (my.cnf) Navigate to the mysqld section of the configuration file Set\naudit_log_strategy='SEMISYNCHRONOUS' (or SYNCHRONOUS)\n",
        "Default Value": "ASYNCHRONOUS\n"
      },
      "code": "control \"M-6.11\" do\n  title \"6.11 Set audit_log_strategy to SYNCHRONOUS or SEMISYNCRONOUS (Scored)\"\n  desc  \"The audit_log_strategy must be set to SYNCHRONOUS or SEMISYNCHRONOUS\nThis setting controls how information is written to the audit log. It can be\nset to SYNCHRONOUS to make it fully durable or other settings which are less\ndurable but have less performance overhead. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_strategy \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.11\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"To assess this recommendation, execute the following SQL\nstatement:\nSHOW GLOBAL VARIABLES LIKE 'audit_log_strategy';\nThe result should be SYNCHRONOUS or SEMISYNCHRONOUS\n\"\n  tag \"fix\": \"To remediate this configuration: Open the MySQL configuration\nfile (my.cnf) Navigate to the mysqld section of the configuration file Set\naudit_log_strategy='SEMISYNCHRONOUS' (or SYNCHRONOUS)\n\"\n  tag \"Default Value\": \"ASYNCHRONOUS\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-6.11.rb",
        "line": 1
      },
      "id": "M-6.11"
    },
    {
      "title": "3.5 Ensure 'relay_log_basename' Files Have Appropriate Permissions and\nOwnership (Scored)",
      "desc": "MySQL can operate using a variety of log files, each used for\ndifferent purposes.  These are the binary log, error log, slow query log, relay\nlog, audit log and general log.  Because these are files on the host operating\nsystem, they are subject to the permissions and ownership structure provided by\nthe host and may be accessible by users other than the MySQL user. Limiting the\naccessibility of these objects will protect the confidentiality, integrity, and\navailability of the MySQL logs.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.5",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following steps to assess this recommendation:\nExecute the following SQL statement to determine the Value of\nrelay_log_basename\nshow variables like 'relay_log_basename'; Execute the following command at a\nterminal prompt to list all relay_log_basename.*\nfiles\nls <relay_log_basename>.* For each file listed, execute the following command\nls -l <relay_log_basename> | egrep '^-[r|w]{2}-[r|w]{2}----\\s*.*$'\nLack of output implies a finding.\n",
        "fix": "Execute the following command for each log file location\nrequiring corrected permissions\nand ownership:\nchmod 660 <log file>\nchown mysql:mysql <log file>\n"
      },
      "code": "control \"M-3.5\" do\n  title \"3.5 Ensure 'relay_log_basename' Files Have Appropriate Permissions and\nOwnership (Scored)\"\n  desc  \"MySQL can operate using a variety of log files, each used for\ndifferent purposes.  These are the binary log, error log, slow query log, relay\nlog, audit log and general log.  Because these are files on the host operating\nsystem, they are subject to the permissions and ownership structure provided by\nthe host and may be accessible by users other than the MySQL user. Limiting the\naccessibility of these objects will protect the confidentiality, integrity, and\navailability of the MySQL logs. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"3.5\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following steps to assess this recommendation:\nExecute the following SQL statement to determine the Value of\nrelay_log_basename\nshow variables like 'relay_log_basename'; Execute the following command at a\nterminal prompt to list all relay_log_basename.*\nfiles\nls <relay_log_basename>.* For each file listed, execute the following command\nls -l <relay_log_basename> | egrep '^-[r|w]{2}-[r|w]{2}----\\\\s*.*$'\nLack of output implies a finding.\n\"\n  tag \"fix\": \"Execute the following command for each log file location\nrequiring corrected permissions\nand ownership:\nchmod 660 <log file>\nchown mysql:mysql <log file>\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-3.5.rb",
        "line": 1
      },
      "id": "M-3.5"
    },
    {
      "title": "1.3 Disable MySQL Command History (Scored)",
      "desc": "On Linux/UNIX, the MySQL client logs statements executed interactively\nto a history file.  By default, this file is named .mysql_history in the user's\nhome directory. Most interactive commands run in the MySQL client application\nare saved to a history file.  The MySQL command history should be disabled.\nDisabling the MySQL command history reduces the probability of exposing\nsensitive information, such as passwords and encryption keys.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1. http://dev.mysql.com/doc/refman/5.7/en/mysql-­‐logging.html 2.\nhttp://bugs.mysql.com/bug.php?id=72158 ",
        "severity": "medium",
        "cis_id": "1.3",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Execute the following commands to assess this\nrecommendation:\nfind /home -name '.mysql_history'\nFor each file returned determine whether that file is symbolically linked to\n/dev/null.\n",
        "fix": "Perform the following steps to remediate this setting: Remove\n.mysql_history if it exists. Use either of the techniques below to prevent it\nfrom being created again: Set the MYSQL_HISTFILE environment variable to\n/dev/null.  This\nwill need to be placed in the shell's startup script. Create\n$HOME/.mysql_history as a symbolic to /dev/null.\n> ln -s /dev/null $HOME/.mysql_history ",
        "Default Value": "By default, the MySQL command history file is located\nin $HOME/.mysql_history.\n\n"
      },
      "code": "control \"M-1.3\" do\n  title \"1.3 Disable MySQL Command History (Scored)\"\n  desc  \"On Linux/UNIX, the MySQL client logs statements executed interactively\nto a history file.  By default, this file is named .mysql_history in the user's\nhome directory. Most interactive commands run in the MySQL client application\nare saved to a history file.  The MySQL command history should be disabled.\nDisabling the MySQL command history reduces the probability of exposing\nsensitive information, such as passwords and encryption keys. \"\n  impact 0.5\n  tag \"ref\": \"1. http://dev.mysql.com/doc/refman/5.7/en/mysql-­‐logging.html 2.\nhttp://bugs.mysql.com/bug.php?id=72158 \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"1.3\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Execute the following commands to assess this\nrecommendation:\nfind /home -name '.mysql_history'\nFor each file returned determine whether that file is symbolically linked to\n/dev/null.\n\"\n  tag \"fix\": \"Perform the following steps to remediate this setting: Remove\n.mysql_history if it exists. Use either of the techniques below to prevent it\nfrom being created again: Set the MYSQL_HISTFILE environment variable to\n/dev/null.  This\nwill need to be placed in the shell's startup script. Create\n$HOME/.mysql_history as a symbolic to /dev/null.\n> ln -s /dev/null $HOME/.mysql_history \"\n  tag \"Default Value\": \"By default, the MySQL command history file is located\nin $HOME/.mysql_history.\\n\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-1.3.rb",
        "line": 1
      },
      "id": "M-1.3"
    },
    {
      "title": "2.4 Do Not Use Default or Shared Cryptographic Material (Not Scored)",
      "desc": "The cryptographic material used by MySQL, such as digital certificates\nand encryption keys, should be used only for MySQL and only for one instance.\nDefault cryptographic material should not be used because others are likely to\nhave copies of them. If an attacker gains access to shared cryptographic\nmaterial, including default material, the attacker can reuse that material to\nimpersonate the MySQL server or otherwise compromise its operations.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "2.4",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "Review all cryptographic material and check to see if any\nof it is default or is used for other\nMySQL instances or for purposes other than MySQL.\n",
        "fix": "Generate new certificates, keys, and other cryptographic material\nas needed for each\naffected MySQL instance. "
      },
      "code": "control \"M-2.4\" do\n  title \"2.4 Do Not Use Default or Shared Cryptographic Material (Not Scored)\"\n  desc  \"The cryptographic material used by MySQL, such as digital certificates\nand encryption keys, should be used only for MySQL and only for one instance.\nDefault cryptographic material should not be used because others are likely to\nhave copies of them. If an attacker gains access to shared cryptographic\nmaterial, including default material, the attacker can reuse that material to\nimpersonate the MySQL server or otherwise compromise its operations. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"2.4\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"Review all cryptographic material and check to see if any\nof it is default or is used for other\nMySQL instances or for purposes other than MySQL.\n\"\n  tag \"fix\": \"Generate new certificates, keys, and other cryptographic material\nas needed for each\naffected MySQL instance. \"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-2.4.rb",
        "line": 1
      },
      "id": "M-2.4"
    },
    {
      "title": "3.4 Ensure 'slow_query_log' Has Appropriate Permissions and Ownership\n(Scored)",
      "desc": "MySQL can operate using a variety of log files, each used for\ndifferent purposes.  These are the binary log, error log, slow query log, relay\nlog, audit log and general log.  Because these are files on the host operating\nsystem, they are subject to the permissions and ownership structure provided by\nthe host and may be accessible by users other than the MySQL user. Limiting the\naccessibility of these objects will protect the confidentiality, integrity, and\navailability of the MySQL logs.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "3.4",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Perform the following steps to assess this recommendation:\nExecute the following SQL statement to determine the Value of\nslow_query_log_file\nshow variables like 'slow_query_log_file'; Execute the following command at a\nterminal prompt to list all slow_query_log_file.*\nfiles\nls <slow_query_log_file>.* For each file listed, execute the following command\n\nls -l <slow_query_log_file> | egrep '^-[r|w]{2}-[r|w]{2}----\\s*.*$'\nLack of output implies a finding.\n",
        "fix": "Execute the following command for each log file location\nrequiring corrected permissions:\nchmod 660 <log file>\nchown mysql:mysql <log file>\n"
      },
      "code": "control \"M-3.4\" do\n  title \"3.4 Ensure 'slow_query_log' Has Appropriate Permissions and Ownership\n(Scored)\"\n  desc  \"MySQL can operate using a variety of log files, each used for\ndifferent purposes.  These are the binary log, error log, slow query log, relay\nlog, audit log and general log.  Because these are files on the host operating\nsystem, they are subject to the permissions and ownership structure provided by\nthe host and may be accessible by users other than the MySQL user. Limiting the\naccessibility of these objects will protect the confidentiality, integrity, and\navailability of the MySQL logs. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"3.4\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Perform the following steps to assess this recommendation:\nExecute the following SQL statement to determine the Value of\nslow_query_log_file\nshow variables like 'slow_query_log_file'; Execute the following command at a\nterminal prompt to list all slow_query_log_file.*\nfiles\nls <slow_query_log_file>.* For each file listed, execute the following command\n\nls -l <slow_query_log_file> | egrep '^-[r|w]{2}-[r|w]{2}----\\\\s*.*$'\nLack of output implies a finding.\n\"\n  tag \"fix\": \"Execute the following command for each log file location\nrequiring corrected permissions:\nchmod 660 <log file>\nchown mysql:mysql <log file>\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-3.4.rb",
        "line": 1
      },
      "id": "M-3.4"
    },
    {
      "title": "1.2 Use Dedicated Least Privileged Account for MySQL Daemon/Service\n(Scored)",
      "desc": "As with any service installed on a host, it can be provided with its\nown user context.  Providing a dedicated user to the service provides the\nability to precisely constrain the service within the larger host context.\nUtilizing a least privilege account for MySQL to execute as may reduce the\nimpact of a MySQL-­‐born vulnerability. A restricted account will be unable to\naccess resources unrelated to MySQL, such as operating system configurations.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/changing-­‐mysql-­‐user.html 2.\nhttp://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_user ",
        "severity": "medium",
        "cis_id": "1.2",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following command at a terminal prompt to\nassess this recommendation:\nps -ef | egrep '^mysql.*$'\nIf no lines are returned, then this is a finding.\nNOTE: It is assumed that the MySQL user is mysql.  Additionally, you may\nconsider running\nsudo -l as the MySQL user or to check the sudoers file.\n",
        "fix": "Create a user which is only used for running MySQL and directly\nrelated processes. This\nuser must not have administrative rights to the system.\n"
      },
      "code": "control \"M-1.2\" do\n  title \"1.2 Use Dedicated Least Privileged Account for MySQL Daemon/Service\n(Scored)\"\n  desc  \"As with any service installed on a host, it can be provided with its\nown user context.  Providing a dedicated user to the service provides the\nability to precisely constrain the service within the larger host context.\nUtilizing a least privilege account for MySQL to execute as may reduce the\nimpact of a MySQL-­‐born vulnerability. A restricted account will be unable to\naccess resources unrelated to MySQL, such as operating system configurations. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/changing-­‐mysql-­‐user.html 2.\nhttp://dev.mysql.com/doc/refman/5.7/en/server-­‐\noptions.html#option_mysqld_user \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"1.2\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following command at a terminal prompt to\nassess this recommendation:\nps -ef | egrep '^mysql.*$'\nIf no lines are returned, then this is a finding.\nNOTE: It is assumed that the MySQL user is mysql.  Additionally, you may\nconsider running\nsudo -l as the MySQL user or to check the sudoers file.\n\"\n  tag \"fix\": \"Create a user which is only used for running MySQL and directly\nrelated processes. This\nuser must not have administrative rights to the system.\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-1.2.rb",
        "line": 1
      },
      "id": "M-1.2"
    },
    {
      "title": "6.9 Ensure audit_log_policy is set to log logins and connections\n(Scored)",
      "desc": "With the audit_log_policy setting the amount of information which is\nsent to the audit log is controlled.  It must be set to log logins and\nconnections. If this setting is set to QUERIES, CONNECTIONS or NONE then either\nconnections or queries are not written to the audit log file.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_policy ",
        "severity": "medium",
        "cis_id": "6.9",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "SHOW GLOBAL VARIABLES LIKE 'audit_log_policy'; The result\nmust be ALL.\n",
        "fix": "Set audit_log_policy='ALL' in the MySQL configuration file and\nactivate the setting by\nrestarting the server or executing SET GLOBAL audit_log_policy='ALL';\n",
        "Default Value": "ALL\n"
      },
      "code": "control \"M-6.9\" do\n  title \"6.9 Ensure audit_log_policy is set to log logins and connections\n(Scored)\"\n  desc  \"With the audit_log_policy setting the amount of information which is\nsent to the audit log is controlled.  It must be set to log logins and\nconnections. If this setting is set to QUERIES, CONNECTIONS or NONE then either\nconnections or queries are not written to the audit log file. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_policy \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.9\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"SHOW GLOBAL VARIABLES LIKE 'audit_log_policy'; The result\nmust be ALL.\n\"\n  tag \"fix\": \"Set audit_log_policy='ALL' in the MySQL configuration file and\nactivate the setting by\nrestarting the server or executing SET GLOBAL audit_log_policy='ALL';\n\"\n  tag \"Default Value\": \"ALL\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-6.9.rb",
        "line": 1
      },
      "id": "M-6.9"
    },
    {
      "title": "2.1 Dedicate Machine Running MySQL (Not Scored)",
      "desc": "It is recommended that MySQL Server software be installed on a\ndedicated server.  This architectural consideration affords flexibility in that\nthe database server can be placed on a separate zone allowing access only from\nparticular hosts and over particular protocols. The attack surface is reduced\non a server with only the underlying operating system, MySQL server software,\nand any security or operational tooling that may be additionally installed.  A\nsmaller attack surface reduces the probability of the data within MySQL being\ncompromised.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "medium",
        "cis_id": "2.1",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Verify there are no other roles enabled for the underlying\noperating system and that no\nadditional applications or services unrelated to the proper operation of the\nMySQL server\nsoftware are installed.\n",
        "fix": "Remove excess applications or services and/or remove unnecessary\nroles from the\nunderlying operating system.\n"
      },
      "code": "control \"M-2.1\" do\n  title \"2.1 Dedicate Machine Running MySQL (Not Scored)\"\n  desc  \"It is recommended that MySQL Server software be installed on a\ndedicated server.  This architectural consideration affords flexibility in that\nthe database server can be placed on a separate zone allowing access only from\nparticular hosts and over particular protocols. The attack surface is reduced\non a server with only the underlying operating system, MySQL server software,\nand any security or operational tooling that may be additionally installed.  A\nsmaller attack surface reduces the probability of the data within MySQL being\ncompromised. \"\n  impact 0.5\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"2.1\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Verify there are no other roles enabled for the underlying\noperating system and that no\nadditional applications or services unrelated to the proper operation of the\nMySQL server\nsoftware are installed.\n\"\n  tag \"fix\": \"Remove excess applications or services and/or remove unnecessary\nroles from the\nunderlying operating system.\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-2.1.rb",
        "line": 1
      },
      "id": "M-2.1"
    },
    {
      "title": "6.10 Ensure audit_log_statement_policy is set to ALL (Scored)",
      "desc": "This setting controls whether statements are written to the audit log\nThis setting must be set to ALL to ensure all statement information is written\nto the audit log.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_statement_policy ",
        "severity": "medium",
        "cis_id": "6.10",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 2,
        "audit text": "SHOW GLOBAL VARIABLES LIKE 'audit_log_statement_policy';\nIt must return ALL\n",
        "fix": "Add this to the mysqld section of the mysql configuration file\nand restart the server:\naudit_log_statement_policy='ALL'\n",
        "Default Value": "ALL\n"
      },
      "code": "control \"M-6.10\" do\n  title \"6.10 Ensure audit_log_statement_policy is set to ALL (Scored)\"\n  desc  \"This setting controls whether statements are written to the audit log\nThis setting must be set to ALL to ensure all statement information is written\nto the audit log. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttps://dev.mysql.com/doc/refman/5.7/en/audit-­‐log-­‐plugin-­‐options-­‐\nvariables.html#sysvar_audit_log_statement_policy \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"6.10\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 2\n  tag \"audit text\": \"SHOW GLOBAL VARIABLES LIKE 'audit_log_statement_policy';\nIt must return ALL\n\"\n  tag \"fix\": \"Add this to the mysqld section of the mysql configuration file\nand restart the server:\naudit_log_statement_policy='ALL'\n\"\n  tag \"Default Value\": \"ALL\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-6.10.rb",
        "line": 1
      },
      "id": "M-6.10"
    },
    {
      "title": "7.8 Ensure No Anonymous Accounts Exist (Scored)",
      "desc": "Anonymous accounts are users with empty usernames ('').  Anonymous\naccounts have no passwords, so anyone can use them to connect to the MySQL\nserver. Removing anonymous accounts will help ensure that only identified and\ntrusted principals are capable of interacting with MySQL.",
      "impact": 0.5,
      "refs": [],
      "tags": {
        "ref": "1.\nhttp://dev.mysql.com/doc/refman/5.7/en/mysql-­‐secure-­‐installation.html 2.\nhttps://dev.mysql.com/doc/refman/5.7/en/default-­‐privileges.html ",
        "severity": "medium",
        "cis_id": "7.8",
        "cis_control": [
          "No CIS Control",
          "6.1"
        ],
        "cis_level": 1,
        "audit text": "Execute the following SQL query to identify anonymous\naccounts:\nSELECT user,host FROM mysql.user WHERE user = '';\nThe above query will return zero rows if no anonymous accounts are present.\n",
        "fix": "Perform the following actions to remediate this setting:\nEnumerate the anonymous users returned from executing the audit procedure For\neach anonymous user, DROP or assign them a name\nNOTE: As an alternative, you may execute the mysql_secure_installation utility.\n\n",
        "Default Value": "Using the standard installation script,\nmysql_install_db, it will create two anonymous\naccounts: one for the host\n'localhost' and the other for the network interface's IP address.\n\n"
      },
      "code": "control \"M-7.8\" do\n  title \"7.8 Ensure No Anonymous Accounts Exist (Scored)\"\n  desc  \"Anonymous accounts are users with empty usernames ('').  Anonymous\naccounts have no passwords, so anyone can use them to connect to the MySQL\nserver. Removing anonymous accounts will help ensure that only identified and\ntrusted principals are capable of interacting with MySQL. \"\n  impact 0.5\n  tag \"ref\": \"1.\nhttp://dev.mysql.com/doc/refman/5.7/en/mysql-­‐secure-­‐installation.html 2.\nhttps://dev.mysql.com/doc/refman/5.7/en/default-­‐privileges.html \"\n  tag \"severity\": \"medium\"\n  tag \"cis_id\": \"7.8\"\n  tag \"cis_control\": [\"No CIS Control\", \"6.1\"]\n  tag \"cis_level\": 1\n  tag \"audit text\": \"Execute the following SQL query to identify anonymous\naccounts:\nSELECT user,host FROM mysql.user WHERE user = '';\nThe above query will return zero rows if no anonymous accounts are present.\n\"\n  tag \"fix\": \"Perform the following actions to remediate this setting:\nEnumerate the anonymous users returned from executing the audit procedure For\neach anonymous user, DROP or assign them a name\nNOTE: As an alternative, you may execute the mysql_secure_installation utility.\n\n\"\n  tag \"Default Value\": \"Using the standard installation script,\nmysql_install_db, it will create two anonymous\\naccounts: one for the host\n'localhost' and the other for the network interface's IP address.\\n\\n\"\nend\n",
      "source_location": {
        "ref": "cis_mysql_enterprise_foundations_baseline/controls/M-7.8.rb",
        "line": 1
      },
      "id": "M-7.8"
    }
  ],
  "groups": [
    {
      "title": null,
      "controls": [
        "M-5.9"
      ],
      "id": "controls/M-5.9.rb"
    },
    {
      "title": null,
      "controls": [
        "M-3.7"
      ],
      "id": "controls/M-3.7.rb"
    },
    {
      "title": null,
      "controls": [
        "M-1.1"
      ],
      "id": "controls/M-1.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.8"
      ],
      "id": "controls/M-4.8.rb"
    },
    {
      "title": null,
      "controls": [
        "M-3.3"
      ],
      "id": "controls/M-3.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-2.2"
      ],
      "id": "controls/M-2.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-1.5"
      ],
      "id": "controls/M-1.5.rb"
    },
    {
      "title": null,
      "controls": [
        "M-3.2"
      ],
      "id": "controls/M-3.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-2.3"
      ],
      "id": "controls/M-2.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-1.4"
      ],
      "id": "controls/M-1.4.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.12"
      ],
      "id": "controls/M-6.12.rb"
    },
    {
      "title": null,
      "controls": [
        "M-5.8"
      ],
      "id": "controls/M-5.8.rb"
    },
    {
      "title": null,
      "controls": [
        "M-3.6"
      ],
      "id": "controls/M-3.6.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.9"
      ],
      "id": "controls/M-4.9.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.4"
      ],
      "id": "controls/M-6.4.rb"
    },
    {
      "title": null,
      "controls": [
        "M-5.3"
      ],
      "id": "controls/M-5.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.2"
      ],
      "id": "controls/M-4.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.5"
      ],
      "id": "controls/M-7.5.rb"
    },
    {
      "title": null,
      "controls": [
        "M-3.9"
      ],
      "id": "controls/M-3.9.rb"
    },
    {
      "title": null,
      "controls": [
        "M-5.7"
      ],
      "id": "controls/M-5.7.rb"
    },
    {
      "title": null,
      "controls": [
        "M-9.3"
      ],
      "id": "controls/M-9.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.1"
      ],
      "id": "controls/M-7.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-8.2"
      ],
      "id": "controls/M-8.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.6"
      ],
      "id": "controls/M-4.6.rb"
    },
    {
      "title": null,
      "controls": [
        "M-3.8"
      ],
      "id": "controls/M-3.8.rb"
    },
    {
      "title": null,
      "controls": [
        "M-5.6"
      ],
      "id": "controls/M-5.6.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.1"
      ],
      "id": "controls/M-6.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-9.2"
      ],
      "id": "controls/M-9.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.7"
      ],
      "id": "controls/M-4.7.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.5"
      ],
      "id": "controls/M-6.5.rb"
    },
    {
      "title": null,
      "controls": [
        "M-5.2"
      ],
      "id": "controls/M-5.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.3"
      ],
      "id": "controls/M-4.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.4"
      ],
      "id": "controls/M-7.4.rb"
    },
    {
      "title": null,
      "controls": [
        "M-5.5"
      ],
      "id": "controls/M-5.5.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.2"
      ],
      "id": "controls/M-6.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-9.1"
      ],
      "id": "controls/M-9.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.3"
      ],
      "id": "controls/M-7.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.4"
      ],
      "id": "controls/M-4.4.rb"
    },
    {
      "title": null,
      "controls": [
        "M-9.5"
      ],
      "id": "controls/M-9.5.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.6"
      ],
      "id": "controls/M-6.6.rb"
    },
    {
      "title": null,
      "controls": [
        "M-5.1"
      ],
      "id": "controls/M-5.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.7"
      ],
      "id": "controls/M-7.7.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.7"
      ],
      "id": "controls/M-6.7.rb"
    },
    {
      "title": null,
      "controls": [
        "M-9.4"
      ],
      "id": "controls/M-9.4.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.1"
      ],
      "id": "controls/M-4.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.6"
      ],
      "id": "controls/M-7.6.rb"
    },
    {
      "title": null,
      "controls": [
        "M-5.4"
      ],
      "id": "controls/M-5.4.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.3"
      ],
      "id": "controls/M-6.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.2"
      ],
      "id": "controls/M-7.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-8.1"
      ],
      "id": "controls/M-8.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-4.5"
      ],
      "id": "controls/M-4.5.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.8"
      ],
      "id": "controls/M-6.8.rb"
    },
    {
      "title": null,
      "controls": [
        "M-3.1"
      ],
      "id": "controls/M-3.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.11"
      ],
      "id": "controls/M-6.11.rb"
    },
    {
      "title": null,
      "controls": [
        "M-3.5"
      ],
      "id": "controls/M-3.5.rb"
    },
    {
      "title": null,
      "controls": [
        "M-1.3"
      ],
      "id": "controls/M-1.3.rb"
    },
    {
      "title": null,
      "controls": [
        "M-2.4"
      ],
      "id": "controls/M-2.4.rb"
    },
    {
      "title": null,
      "controls": [
        "M-3.4"
      ],
      "id": "controls/M-3.4.rb"
    },
    {
      "title": null,
      "controls": [
        "M-1.2"
      ],
      "id": "controls/M-1.2.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.9"
      ],
      "id": "controls/M-6.9.rb"
    },
    {
      "title": null,
      "controls": [
        "M-2.1"
      ],
      "id": "controls/M-2.1.rb"
    },
    {
      "title": null,
      "controls": [
        "M-6.10"
      ],
      "id": "controls/M-6.10.rb"
    },
    {
      "title": null,
      "controls": [
        "M-7.8"
      ],
      "id": "controls/M-7.8.rb"
    }
  ],
  "attributes": [],
  "sha256": "22f3bbca2ff00a17d74fe8fa33e356312671fb2d8d94f0f0f525490e04e24ba0",
  "generator": {
    "name": "inspec",
    "version": "2.1.0"
  }
}
